<ui:composition
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:of="http://omnifaces.org/functions"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	template="/uii/templatePG/templatePG.html"
	xmlns:x="http://myfaces.apache.org/tomahawk"
	xmlns:intranda="http://xmlns.jcp.org/jsf/composite/compositesPG"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:jsf="http://xmlns.jcp.org/jsf">

	<ui:param
		name="myPageTitle"
		value="#{ProzessverwaltungForm.modusAnzeige=='aktuell'?msgs.aktuelleProzesse:msgs.prozessvorlagen}" />

	<ui:define name="title">
		<h:outputText value="#{myPageTitle}" />
	</ui:define>

	<ui:define name="breadcrumb">
		<intranda:breadcrumb
			id="id2"
			label="#{DashboardForm.plugin==null?msgs.startseite:msgs.dashboard}"
			action="index"
			navId="a0" />
		<intranda:breadcrumb
			id="processAll"
			label="#{myPageTitle}"
			action="process_all"
			noSeparator="#{true}" />
	</ui:define>

	<ui:define name="info">
	</ui:define>

	<ui:define name="content">
		<link
			rel="stylesheet"
			href="template/css/codemirror/codemirror.css?v=#{HelperForm.buildVersion}" />
		<script
			type="text/javascript"
			src="template/js/codemirror/codemirror.js?v=#{HelperForm.buildVersion}" />
		<script
			src="template/js/codemirror/mode/yaml/yaml.js?v=#{HelperForm.buildVersion}" />

		<style>
.CodeMirror {
	border: 1px solid #ddd;
}
</style>


		<main id="processAll">
			<c:if
				test="#{LoginForm.hasRole('Workflow_Processes') or LoginForm.hasRole('Workflow_ProcessTemplates')}">

				<div class="row">
					<div class="col-sm-12">

						<intranda:box
							id="processAllProcessesBox"
							boxType="primary"
							icon="fa-tasks"
							title="#{myPageTitle}">

							<div class="gw-table">

                                <!-- SEARCH AREA -->
								<h:form id="searchform">
									<div class="gw-table__search">
										<div class="gw-table__search__length">
											<button
												class="btn btn-blank"
												jsf:action="#{ProzessverwaltungForm.generateFilterWithIdentfiers}"
												data-bs-toggle="tooltip"
												title="#{msgs.process_generateFilterQueryForHits}">
												<span class="fa fa-filter" />
												<span>
													<h:outputText
														value="#{msgs.treffer}: #{ProzessverwaltungForm.paginator.totalResults}" />
												</span>
											</button>
										</div>

										<div class="gw-table__filters">
											<ui:include
												src="templatePG/includes/process/list_filterAndDisplay.xhtml" />
											<x:aliasBeansScope>
												<x:aliasBean
													alias="#{Form}"
													value="#{ProzessverwaltungForm}" />
												<x:aliasBean
													alias="#{label}"
													value="#{ProzessverwaltungForm.modusAnzeige=='aktuell'?msgs.filterProcesses:msgs.filterProcessTemplates}" />
												<f:subview id="sub1">
													<ui:include
														src="templatePG/includes/task/list_searchAndSave.xhtml" />
												</f:subview>
											</x:aliasBeansScope>
										</div>

									</div>
								</h:form>
                                <!-- // SEARCH AREA -->

								<h:form id="myform">

                                    <!-- DISPLAY AS GRID -->
									<h:panelGroup
										rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['gridview']}">
										<ui:include src="templatePG/includes/process/list_grid.xhtml" />
									</h:panelGroup>
                                    <!-- // DISPLAY AS GRID -->

                                     <!-- DISPLAY AS TABLE -->
									<div class="gw-table__wrapper">
										<table
											role="grid"
											id="#{ProzessverwaltungForm.modusAnzeige=='vorlagen' ? 'templateTable' : 'processTable'}"
											class="table table-hover table-nomargin dataTable table-bordered table-resizable responsive processTable"
											jsf:rendered="#{ProzessverwaltungForm.modusAnzeige=='vorlagen' or not ProzessverwaltungForm.anzeigeAnpassen['gridview']}">

											<!-- ### Columnheader row ### -->
											<thead>
												<tr role="row">

													<!-- SELECTION COLUMN HEADER -->
													<th
														id="selection"
														class="header__selection header__col-l"
														jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['selectionBoxes']}">
														<div class="d-flex">

															<button
																jsf:action="#{ProzessverwaltungForm.selectionAll}"
																jsf:id="selectall"
																title="#{msgs.alleAuswaehlen}"
																class="btn p-2">
																<span class="fa fa-check-square-o font-black" />
															</button>
															<button
																jsf:action="#{ProzessverwaltungForm.selectionNone}"
																jsf:id="selectnone"
																title="#{msgs.auswahlEntfernen}"
																class="btn p-2">
																<span class="fa fa-square-o font-black" />
															</button>

														</div>
													</th>

													<!-- PROCESS ID COLUMN HEADER -->
													<intranda:columnheader
														id="id"
														addClass="header__id header__col-s"
														name="id"
														form="#{ProzessverwaltungForm}"
														value="#{msgs.id}"
														rendered="#{ProzessverwaltungForm.anzeigeAnpassen['processId']}"
														ajaxRender="processAllProcessesBox:myform"
														reverseOrder="true"
														sortField="prozesse.ProzesseID" />

                                                    <!-- THUMBNAIL COLUMN HEADER -->
													<intranda:columnheader
														id="thumbnail"
														addClass="header__thumbnail header__col-xl"
														value="#{msgs.thumbnail}"
														rendered="#{ProzessverwaltungForm.anzeigeAnpassen['thumbnail'] and ProzessverwaltungForm.modusAnzeige!='vorlagen'}"
														sortable="false" />

                                                    <!-- METADATA COLUMN HEADER -->
													<intranda:columnheader
														id="embedded-metadata"
														addClass="header__embedded-metadata header__col-xxxl"
														value="#{msgs.metadata}"
														rendered="#{ProzessverwaltungForm.anzeigeAnpassen['metadatadetails'] and ProzessverwaltungForm.modusAnzeige!='vorlagen'}"
														sortable="false" />

                                                    <!-- BATCH ID COLUMN HEADER -->
													<intranda:columnheader
														id="batch-id"
														addClass="header__batch-id header__col-m"
														name="batch"
														form="#{ProzessverwaltungForm}"
														value="#{msgs.batch}"
														rendered="#{ProzessverwaltungForm.anzeigeAnpassen['batchId'] and ProzessverwaltungForm.modusAnzeige!='vorlagen'}"
														ajaxRender="processAllProcessesBox:myform"
                                                        sortField="prozesse.batchID" />

                                                    <!-- PROCESS TITLE COLUMN HEADER -->
													<intranda:columnheader
														addClass="header__title header__col-xxxl"
														name="titel"
														form="#{ProzessverwaltungForm}"
														value="#{ProzessverwaltungForm.modusAnzeige=='aktuell'?msgs.prozessTitel:msgs.titel}"
														rendered="true"
														ajaxRender="processAllProcessesBox:myform"
														id="ajaxcolumn"
                                                        sortField="prozesse.titel" />

                                                    <!-- CUSTOM COLUMNS HEADER -->
                                                    <ui:fragment rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen'}">
                                                        <c:forEach
                                                            items="#{LoginForm.listOfCustomColumns}"
                                                            var="var">
                                                            <intranda:columnheader
                                                                addClass="header__custom-column header__col-m"
                                                                form="#{ProzessverwaltungForm}"
                                                                ajaxRender="processAllProcessesBox:myform"
                                                                value="#{msgs[fn:substring(var, fn:indexOf(var,'.') lt 0 ? 1 : fn:indexOf(var,'.') + 1, var.length() - fn.indexOf(var,'.') - 1)]}"
                                                                sortField="#{var}"
                                                                rendered="#{LoginForm.isDisplaySortfield(var)}" />
                                                            <intranda:columnheader
                                                                addClass="header__custom-column header__col-m"
                                                                sortable="false"
                                                                value="#{msgs[fn:substring(var, fn:indexOf(var,'.') lt 0 ? 1 : fn:indexOf(var,'.') + 1, var.length() - fn.indexOf(var,'.') - 1)]}"
                                                                rendered="#{!LoginForm.isDisplaySortfield(var)}" />
                                                        </c:forEach>
                                                    </ui:fragment>
                                                    <!-- CREATION DATE COLUMN HEADER -->
													<intranda:columnheader
														id="date"
														addClass="header__date header__col-l"
														name="vorgangsdatum"
														form="#{ProzessverwaltungForm}"
														value="#{msgs.vorgangsdatum}"
														rendered="#{ProzessverwaltungForm.anzeigeAnpassen['processDate']}"
														ajaxRender="processAllProcessesBox:myform"
                                                        sortField="prozesse.erstellungsdatum" />

                                                    <!-- RULESET COLUMN HEADER -->
													<intranda:columnheader
														addClass="header__ruleset header__col-l"
														value="#{msgs.regelsatz}"
														rendered="#{ProzessverwaltungForm.anzeigeAnpassen['processRuleset']}"
														sortable="false" />

                                                    <!-- STATUS COLUMN HEADER -->
													<intranda:columnheader
														id="progress"
														addClass="header__progress header__col-xl"
														name="fortschritt"
														form="#{ProzessverwaltungForm}"
														value="#{msgs.status}"
														ajaxRender="processAllProcessesBox:myform"
                                                        sortField="prozesse.sortHelperStatus" />

                                                    <!-- PROJECT COLUMN HEADER -->
													<intranda:columnheader
														id="project"
														addClass=" #{item.getProjekt().projectIsArchived?'font-status-deactivated':'font-black'} header__project header__col-l"
														name="projekt"
														form="#{ProzessverwaltungForm}"
														value="#{msgs.projekt}"
														ajaxRender="processAllProcessesBox:myform"
                                                        sortField="projekte.titel" />

                                                    <!-- INSTITUTION COLUMN HEADER -->
													<intranda:columnheader
														id="institution"
														addClass="header__institution header__col-l"
														name="institution"
														form="#{ProzessverwaltungForm}"
														value="#{msgs.institution}"
														rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['institution']}"
														ajaxRender="processAllProcessesBox:myform"
                                                        sortField="institution.shortName" />

                                                    <!-- LOCKINGS COLUMN HEADER -->
													<intranda:columnheader
														id="lockings"
														rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['lockings']}"
														addClass="header__lockings header__col-s"
														name="sperrungen"
														form="#{ProzessverwaltungForm}"
														value="#{msgs.sperrungen}"
														ajaxRender="processAllProcessesBox:myform"
                                                        sortable="false" />

                                                    <!-- LAST STATUS UPDATE DATE COLUMN HEADER -->
													<intranda:columnheader
														id="update-date"
														addClass="header__update-date header__col-l"
														value="#{msgs.lastStatusUpdate}"
														rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['editionDate']}"
														sortable="false" />

													<!-- LAST STATUS UPDATE USER COLUMN HEADER -->
													<intranda:columnheader
														id="update-user"
														addClass="header__update-user header__col-l"
														value="#{msgs.userLastStatusUpdate}"
														rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['editionUser']}"
														sortable="false" />

                                                    <!-- LAST STATUS UPDATE TASK COLUMN HEADER -->
													<intranda:columnheader
														id="update-task"
														addClass="header__update-task header__col-l"
														value="#{msgs.taskLastStatusUpdate}"
														rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['editionTask']}"
														sortable="false" />

													<!-- SWAPPED OUT COLUMN HEADER -->
													<intranda:columnheader
														id="swapped"
														addClass="header__swapped header__col-l"
														value="#{msgs.ausgelagert}"
														rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['swappedOut']}"
														sortable="false" />

													<!-- NUMBER OF IMAGES COLUMN HEADER -->
													<intranda:columnheader
														id="number-of-imgs"
														rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['numberOfImages']}"
														value="#{msgs.NumberOfImages}"
														addClass="header__number-of-imgs header__col-l"
														name="numberOfImages"
                                                        sortField="sortHelperImages"
														form="#{ProzessverwaltungForm}"
														ajaxRender="processAllProcessesBox:myform" />

                                                    <!-- BUTTONS COLUMN HEADER -->
													<intranda:columnheader
														id="buttons"
                                                        addClass="header__buttons header__col-xl #{ProzessverwaltungForm.modusAnzeige=='vorlagen' ? 'header__col-min-xxl' : 'header__col-min-xl'}"
														value="#{msgs.auswahl}"
														sortable="false" />
												</tr>
											</thead>



											<ui:repeat
												var="item"
												value="#{ProzessverwaltungForm.paginator.list}"
												varStatus="status">
												<tr role="row">
													<!-- Selection Boxes -->
													<td
														data-label="#{msgs.auswahl2}"
														class=" width120"
														jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['selectionBoxes']}">
														<div class="cell">
															<button
																jsf:id="selected"
																aria-label="#{msgs.auswahl2}"
																class="btn btn-blank"
																onclick="gwResizableTable.reload()">
																<i
																	class="#{item.selected?'fa fa-check-square-o':'fa fa-square-o'}" />
																<f:setPropertyActionListener
																	target="#{item.selected}"
																	value="#{item.selected?false:true}" />
																<f:ajax render="processAllProcessesBox:myform" />
															</button>
														</div>
													</td>
													<!-- Process Id -->
													<td
														data-label="#{msgs.id}"
														jsf:rendered="#{ProzessverwaltungForm.anzeigeAnpassen['processId']}"
														class="wb-normal">
														<h:outputText value="#{item.id}" />
													</td>
													<!-- thumbnail -->
													<td
														data-label="#{msgs.thumbnail}"
														jsf:rendered="#{ProzessverwaltungForm.anzeigeAnpassen['thumbnail'] and ProzessverwaltungForm.modusAnzeige!='vorlagen'}">
														<canvas
															class="thumb-canvas"
															data-image_small="#{item.getRepresentativeImage(250)}"
															data-image_large="#{item.getRepresentativeImage(750)}"
															id="thumbnail-#{item.id}">
                                            </canvas>
													</td>

													<!-- Embedded Metadata -->
													<td
														data-label="#{msgs.metadataList}"
														jsf:rendered="#{ProzessverwaltungForm.anzeigeAnpassen['metadatadetails'] and ProzessverwaltungForm.modusAnzeige!='vorlagen'}">
														<table class="metadata-nested-table no-borders">
															<ui:repeat
																var="metadata"
																value="#{item.metadataList}"
																varStatus="metadatastatus"
																id="metadatalist">
																<h:panelGroup
																	rendered="#{metadata.one == 'TitleDocMain'
						                                              or metadata.one == 'Author'
						                                              or metadata.one == 'PlaceOfPublication'
						                                              or metadata.one == 'PublicationYear'
						                                              or metadata.one == 'PublisherName'
						                                              or metadata.one == 'CatalogIDDigital'
						                                              or metadata.one == 'shelfmarksource'}">
																	<tr>
																		<td class="data-key">
																			<h:outputText
																				value="#{msgs['process_grid_'.concat(metadata.one)]}:" />
																		</td>
																		<td>
																			<h:outputText value="#{metadata.two}" />
																		</td>
																	</tr>
																</h:panelGroup>
															</ui:repeat>
														</table>
													</td>

													<!-- Batch id -->
													<td
														data-label="#{msgs.batch}"
														class="gw-hyphens-none"
														jsf:rendered="#{ProzessverwaltungForm.anzeigeAnpassen['batchId'] and ProzessverwaltungForm.modusAnzeige!='vorlagen'}">
														<h:outputText
															value="#{item.batch.batchId}"
															rendered="#{item.batch != null}" />
														<h:outputText
															value=" (#{item.batch.batchName})"
															rendered="#{item.batch != null and item.batch.batchName != null}" />
													</td>

													<!-- Alle Schritte Auflisten -->
													<td
														data-label="#{msgs.ProzessverwaltungForm}"
														class="prozessVerwaltung">
														<ui:include
															src="templatePG/includes/ajaxPlusMinusButton.xhtml">
															<ui:param
                                                                name="ajaxRender"
                                                                value="processAllProcessesBox:myform" />
                                                            <ui:param
																name="tooltips"
																value="#processTable" />
														</ui:include>
														<h:panelGroup rendered="#{item.panelAusgeklappt}">

															<intranda:box
																boxScope="boxTitleDetails"
																boxType="primary"
																boxSmall="true"
																boxPadding="false"
																icon="fa-list"
																title="#{msgs.details}">

																<div class="gw-table">
																	<div class="gw-table__wrapper">

																		<x:dataTable
																			styleClass="table table-hover table-bordered"
																			id="prozessdetails"
																			var="step"
																			value="#{item.schritteList}">

																			<h:column>
																				<f:facet name="header">
																					<h:outputText value="#{msgs.nr}" />
																				</f:facet>
																				<h:outputText
																					value="#{step.reihenfolge}"
																					styleClass="#{step.bearbeitungsstatusEnum == 'DEACTIVATED'?'font-light':''}" />
																			</h:column>

																			<h:column>
																				<f:facet name="header">
																					<h:outputText
																						value="#{msgs.titel}"
																						style="white-space: normal;" />
																				</f:facet>
																				<div class="icon-text">
																					<h:panelGroup rendered="#{step.typAutomatisch}">
																						<span
																							class="fa fa-cogs font-light"
																							title="#{msgs.automatischerSchritt}"
																							data-bs-toggle="tooltip" />
																					</h:panelGroup>
																					<h:panelGroup rendered="#{not step.typAutomatisch}">
																						<span
																							class="fa fa-user-o font-light #{step.bearbeitungsstatusEnum == 'DEACTIVATED'?'font-light':''}"
																							title="#{msgs.normalerSchritt}"
																							data-bs-toggle="tooltip" />
																					</h:panelGroup>
																					<h:outputText
																						value="#{step.titelLokalisiert}"
																						title="#{step.titel}"
																						data-bs-toggle="tooltip"
																						styleClass="#{step.reihenfolge}_id #{step.bearbeitungsstatusEnum == 'DEACTIVATED'?'font-light':''}" />
																				</div>
																			</h:column>

																			<h:column>
																				<f:facet name="header">
																					<h:outputText value="#{msgs.status}" />
																				</f:facet>

																				<ul class="colors small13">
																					<h:panelGroup
																						rendered="#{step.bearbeitungsstatusEnum == 'LOCKED'}">
																						<li
																							class="statusSmall #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-'):('')).concat(step.bearbeitungsstatusEnum.color)}"
																							title="#{msgs.statusGesperrt}"
																							data-bs-toggle="tooltip"><h:outputText
																								value="#{step.bearbeitungsstatusEnum.title}"
																								rendered="#{LoginForm.myBenutzer.uiMode=='low_vision'}" /></li>
																					</h:panelGroup>
																					<h:panelGroup
																						rendered="#{step.bearbeitungsstatusEnum == 'OPEN'}">
																						<li
																							class="statusSmall #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-'):('')).concat(step.bearbeitungsstatusEnum.color)}"
																							title="#{msgs.statusOffen}"
																							data-bs-toggle="tooltip"><h:outputText
																								value="#{step.bearbeitungsstatusEnum.title}"
																								rendered="#{LoginForm.myBenutzer.uiMode=='low_vision'}" /></li>
																					</h:panelGroup>

																					<h:panelGroup
																						rendered="#{step.bearbeitungsstatusEnum == 'DONE' and HelperForm.anonymized}">
																						<li
																							class="statusSmall #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-'):('')).concat(step.bearbeitungsstatusEnum.color)}"
																							data-bs-toggle="tooltip"
																							title="#{step.bearbeitungsstatusEnum.title} #{step.editTypeEnum.title}"><h:outputText
																								value="#{step.bearbeitungsstatusEnum.title}"
																								rendered="#{LoginForm.myBenutzer.uiMode=='low_vision'}" /></li>
																					</h:panelGroup>
																					<h:panelGroup
																						rendered="#{step.bearbeitungsstatusEnum == 'INWORK' and HelperForm.anonymized}">
																						<li
																							class="statusSmall #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-'):('')).concat(step.bearbeitungsstatusEnum.color)}"
																							data-bs-toggle="tooltip"
																							title="#{step.bearbeitungsstatusEnum.title}: #{step.editTypeEnum.title}"><h:outputText
																								value="#{step.bearbeitungsstatusEnum.title}"
																								rendered="#{LoginForm.myBenutzer.uiMode=='low_vision'}" /></li>
																					</h:panelGroup>

																					<h:panelGroup
																						rendered="#{step.bearbeitungsstatusEnum == 'DONE' and !HelperForm.anonymized}">
																						<li
																							class="statusSmall #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-'):('')).concat(step.bearbeitungsstatusEnum.color)}"
																							data-bs-toggle="tooltip"
																							title="#{step.bearbeitungsstatusEnum.title}: #{step.bearbeitungsbenutzer!=null and step.bearbeitungsbenutzer.id!=0?step.bearbeitungsbenutzer.nachVorname:''} (#{step.bearbeitungszeitpunkt !=null?step.bearbeitungszeitpunktAsFormattedString:''})  - #{step.editTypeEnum.title}"><h:outputText
																								value="#{step.bearbeitungsstatusEnum.title}"
																								rendered="#{LoginForm.myBenutzer.uiMode=='low_vision'}" /></li>
																					</h:panelGroup>
																					<h:panelGroup
																						rendered="#{step.bearbeitungsstatusEnum == 'INWORK' and !HelperForm.anonymized}">
																						<li
																							class="statusSmall #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-'):('')).concat(step.bearbeitungsstatusEnum.color)}"
																							data-bs-toggle="tooltip"
																							title="#{step.bearbeitungsstatusEnum.title}: #{step.bearbeitungsbenutzer!=null and step.bearbeitungsbenutzer.id!=0?step.bearbeitungsbenutzer.nachVorname:''} (#{step.bearbeitungszeitpunkt !=null?step.bearbeitungszeitpunktAsFormattedString:''})  - #{step.editTypeEnum.title}"><h:outputText
																								value="#{step.bearbeitungsstatusEnum.title}"
																								rendered="#{LoginForm.myBenutzer.uiMode=='low_vision'}" /></li>
																					</h:panelGroup>
																					<h:panelGroup
																						rendered="#{step.bearbeitungsstatusEnum == 'ERROR' and !HelperForm.anonymized}">
																						<li
																							class="statusSmall #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-'):('')).concat(step.bearbeitungsstatusEnum.color)}"
																							data-bs-toggle="tooltip"
																							title="#{step.bearbeitungsstatusEnum.title}: #{step.bearbeitungsbenutzer!=null and step.bearbeitungsbenutzer.id!=0?step.bearbeitungsbenutzer.nachVorname:''} (#{step.bearbeitungszeitpunkt !=null?step.bearbeitungszeitpunktAsFormattedString:''})  - #{step.editTypeEnum.title}"><h:outputText
																								value="#{step.bearbeitungsstatusEnum.title}"
																								rendered="#{LoginForm.myBenutzer.uiMode=='low_vision'}" /></li>
																					</h:panelGroup>
																					<h:panelGroup
																						rendered="#{step.bearbeitungsstatusEnum == 'ERROR' and HelperForm.anonymized}">
																						<li
																							class="statusSmall #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-'):('')).concat(step.bearbeitungsstatusEnum.color)}"
																							data-bs-toggle="tooltip"
																							title="#{step.bearbeitungsstatusEnum.title}: #{step.editTypeEnum.title}"><h:outputText
																								value="#{step.bearbeitungsstatusEnum.title}"
																								rendered="#{LoginForm.myBenutzer.uiMode=='low_vision'}" /></li>
																					</h:panelGroup>

																					<h:panelGroup
																						rendered="#{step.bearbeitungsstatusEnum == 'DEACTIVATED'}">
																						<li
																							class="statusSmall #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-'):('')).concat(step.bearbeitungsstatusEnum.color)}"
																							title="#{step.bearbeitungsstatusEnum.title}"
																							data-bs-toggle="tooltip"><h:outputText
																								value="#{step.bearbeitungsstatusEnum.title}"
																								rendered="#{LoginForm.myBenutzer.uiMode=='low_vision'}" /></li>
																					</h:panelGroup>

																					<h:panelGroup
																						rendered="#{step.bearbeitungsstatusEnum == 'INFLIGHT'}">
																						<li
																							class="statusSmall #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-'):('')).concat(step.bearbeitungsstatusEnum.color)}"
																							title="#{msgs.statusInFlight}"
																							data-bs-toggle="tooltip"><h:outputText
																								value="#{step.bearbeitungsstatusEnum.title}"
																								rendered="#{LoginForm.myBenutzer.uiMode=='low_vision'}" /></li>
																					</h:panelGroup>
																				</ul>

																			</h:column>

																		</x:dataTable>

																	</div>
																	<!--/gw-table-->
																</div>
																<!--/gw-table__wrapper-->

															</intranda:box>

														</h:panelGroup>
													</td>

													<!-- CUSTOM COLUMNS -->
                                                    <ui:fragment rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen'}">
    													<c:forEach
    														items="#{LoginForm.listOfCustomColumns}"
    														var="var">
    														<td
    															data-label="#{msgs[fn:substring(var, fn:indexOf(var,'.') lt 0 ? 1 : fn:indexOf(var,'.') + 1, var.length() - fn.indexOf(var,'.') - 1)]}">
    															<h:outputText value="#{item.getReplacedVariable(var)}" />
    														</td>
    													</c:forEach>
                                                    </ui:fragment>
													<!-- PROCESS DATE -->
													<td
														data-label="#{msgs.vorgangsdatum}"
														jsf:rendered="#{ProzessverwaltungForm.anzeigeAnpassen['processDate']}">
														<h:outputText value="#{item.erstellungsdatumAsString}">
														</h:outputText>
													</td>

													<!-- RULESET -->
													<td
														data-label="#{msgs.regelsatz}"
														jsf:rendered="#{ProzessverwaltungForm.anzeigeAnpassen['processRuleset']}">
														<h:outputText value="#{item.regelsatz.titel}" />
													</td>

													<!-- STATUS -->
													<td
														data-label="#{msgs.status}">

														<div class="progress__container">
															<h:panelGroup
																rendered="#{item.fortschritt3 gt 0}"
																styleClass="progress-bar #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-progressbar-status-done'):('progress-bar-success'))}"
																pt:role="figure"
																pt:aria-label="#{item.fortschritt3}% #{msgs.statusAbgeschlossen}">
																<h:outputText value="&#160;" />
																<f:passThroughAttribute
																	name="style"
																	value ="--progress: #{item.fortschritt3}%" />
																<f:passThroughAttribute
																	name="data-bs-container"
																	value="body" />
																<f:passThroughAttribute
																	name="data-bs-toggle"
																	value="popover" />
																<f:passThroughAttribute
																	name="data-bs-placement"
																	value="top" />
																<f:passThroughAttribute
																	name="data-bs-html"
																	value="true" />
																<f:passThroughAttribute
																	name="data-bs-content"
																	value="&lt;b class='font-status-done'&gt;#{msgs.statusAbgeschlossen}:&lt;/b&gt;&lt;br/&gt; #{item.getStepsAsString(3, ', ')}" />
															</h:panelGroup>

															<h:panelGroup
																rendered="#{item.fortschritt2 gt 0}"
																styleClass="progress-bar #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-progressbar-status-open'):('progress-bar-warning'))}"
																pt:role="figure"
																pt:aria-label="#{item.fortschritt2}% #{msgs.statusOffen} / #{msgs.statusInBearbeitung}">
																<h:outputText value="&#160;" />
																<f:passThroughAttribute
																	name="style"
																	value ="--progress: #{item.fortschritt2}%" />
																<f:passThroughAttribute
																	name="data-bs-container"
																	value="body" />
																<f:passThroughAttribute
																	name="data-bs-toggle"
																	value="popover" />
																<f:passThroughAttribute
																	name="data-bs-placement"
																	value="top" />
																<f:passThroughAttribute
																	name="data-bs-html"
																	value="true" />
																<f:passThroughAttribute
																	name="data-bs-content"
																	value="&lt;b class='font-status-open'&gt;#{msgs.statusOffen} / #{msgs.statusInBearbeitung}:&lt;/b&gt;&lt;br/&gt; #{item.getStepsAsString(1, ', ')}#{item.getStepsAsString(1, ', ') ne '' and item.getStepsAsString(2, ', ') ne ''?', ':''} #{item.getStepsAsString(2, ', ')} #{item.getStepsAsString(1, ', ') ne '' or item.getStepsAsString(1, ', ') ne ''  ?', ':''} #{item.getStepsAsString(6, ', ')}" />
															</h:panelGroup>

															<h:panelGroup
																rendered="#{item.fortschrittError gt 0}"
																styleClass="progress-bar #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-progressbar-status-error'):('progress-bar-danger progressbar-status-error'))} "
																pt:role="figure"
																pt:aria-label="#{item.fortschrittError}% #{msgs.statusError}">
																<h:outputText value="&#160;" />
																<f:passThroughAttribute
																	name="style"
																	value ="--progress: #{item.fortschrittError}%" />
																<f:passThroughAttribute
																	name="data-bs-container"
																	value="body" />
																<f:passThroughAttribute
																	name="data-bs-toggle"
																	value="popover" />
																<f:passThroughAttribute
																	name="data-bs-placement"
																	value="top" />
																<f:passThroughAttribute
																	name="data-bs-html"
																	value="true" />
																<f:passThroughAttribute
																	name="data-bs-content"
																	value="&lt;b class='font-status-error'&gt;#{msgs.statusError}:&lt;/b&gt;&lt;br/&gt; #{item.getStepsAsString(4, ', ')}" />
															</h:panelGroup>

															<h:panelGroup
																rendered="#{item.fortschritt1 gt 0}"
																styleClass="progress-bar #{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-progressbar-status-locked'):('progress-bar-danger'))} "
																pt:role="figure"
																pt:aria-label="#{item.fortschritt1}% #{msgs.statusGesperrt}">
																<h:outputText value="&#160;" />
																<f:passThroughAttribute
																	name="style"
																	value ="--progress: #{item.fortschritt1}%" />
																<f:passThroughAttribute
																	name="data-bs-container"
																	value="body" />
																<f:passThroughAttribute
																	name="data-bs-toggle"
																	value="popover" />
																<f:passThroughAttribute
																	name="data-bs-placement"
																	value="top" />
																<f:passThroughAttribute
																	name="data-bs-html"
																	value="true" />
																<f:passThroughAttribute
																	name="data-bs-content"
																	value="&lt;b class='font-status-locked'&gt;#{msgs.statusGesperrt}:&lt;/b&gt;&lt;br/&gt; #{item.getStepsAsString(0, ', ')}" />
															</h:panelGroup>
														</div>
													</td>
													<!-- // STATUS -->

													<!-- PROJECT -->
													<td
														data-label="#{msgs.projekt}">
														<h:outputText
															value="#{item.projekt.titel}"
															styleClass=" #{item.getProjekt().projectIsArchived?'font-status-deactivated':'font-black'}" />
													</td>

													<!-- INSTITUTION -->
													<td
														data-label="#{msgs.institution}"
														jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['institution']}">
														<h:outputText
															value="#{item.projekt.institution.shortName}" />
													</td>

													<!-- LOCKINGS -->
													<td
														data-label="#{msgs.sperrungen}"
														jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['lockings']}">
														<h:outputText
															value="#{item.benutzerGesperrt.nachVorname}"
															rendered="#{item.benutzerGesperrt != null}" />
													</td>

													<!-- LAST CHANGE DATE -->
													<td
														data-label="#{msgs.lastStatusUpdate}"
														jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['editionDate']}">
														<h:outputText value="#{item.lastStatusChangeDate}" />
													</td>

													<!-- LAST CHANGE USER -->
													<td
														data-label="#{msgs.userLastStatusUpdate}"
														jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['editionUser']}">
														<h:outputText value="#{item.lastStatusChangeUser}" />
													</td>

													<!-- LAST CHANGE TASK -->
													<td
														data-label="#{msgs.taskLastStatusUpdate}"
														jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['editionTask']}">
														<h:outputText value="#{item.lastStatusChangeTask}" />
													</td>

													<!-- SWAPPING -->
													<td
														data-label="#{msgs.ausgelagert}"
														jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['swappedOut']}">
														<i
															class="fa #{item.swappedOutGui?'fa-check-square-o':'fa-square-o'}" />
													</td>

													<!-- NUMBER OF IMAGES -->
													<td
														data-label="#{msgs.NumberOfImages}"
														jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['numberOfImages']}">
														<h:outputText value="#{item.sortHelperImages}" />
													</td>

													<!-- BUTTONS -->
													<td
														data-label="#{msgs.auswahl}">

														<div class="gw-table__actions__container">

															<!-- EDIT PROCESS -->
															<button
																jsf:action="#{ProzessverwaltungForm.editProcess}"
																jsf:id="edit"
																aria-label="#{msgs.bearbeiten}"
																jsf:rendered="#{LoginForm.hasRole('Workflow_General_Details')}"
																jsf:rel="tooltip"
																onclick="preventDoubleSubmit(this);"
																title="#{ProzessverwaltungForm.modusAnzeige=='aktuell'?msgs.prozessBearbeiten:msgs.process_editTemplate}"
																data-bs-toggle="tooltip"
																class="btn btn-blank">
																<span class="fa fa-pencil" />
																<x:updateActionListener
																	property="#{ProzessverwaltungForm.myProzess}"
																	value="#{item}" />
																<x:updateActionListener
																	property="#{ProzessverwaltungForm.modusBearbeiten}"
																	value="" />
															</button>

															<!-- CLONE PROCESS TEMPLATE -->
															<button
																class="btn btn-blank"
																aria-label="#{msgs.duplicate}"
																jsf:action="#{ProzessverwaltungForm.cloneProcess}"
																jsf:rel="tooltip"
																jsf:rendered="#{LoginForm.hasRole('Workflow_ProcessTemplates_Clone') and (ProzessverwaltungForm.modusAnzeige=='vorlagen')}"
																data-bs-toggle="tooltip"
																title="#{msgs.duplicate}"
																onclick="if (!confirm('#{msgs.wirklichAusfuehren}')) return false">
																<span class="fa fa-clipboard" />
																<x:updateActionListener
																	property="#{ProzessverwaltungForm.myProzess}"
																	value="#{item}" />
															</button>

															<!-- METADATA EDITOR - READ ONLY -->
															<h:commandLink
																styleClass="btn btn-blank"
																action="#{Metadaten.XMLlesen}"
																id="action14"
																rel="tooltip"
																title="#{msgs.metadatenBearbeiten}"
																pt:data-bs-toggle="tooltip"
																onclick="preventDoubleSubmit(this); sessionStorage.removeItem('columnWidths');"
																rendered="#{(!LoginForm.hasRole('Task_Mets_Pagination') and !LoginForm.hasRole('Task_Mets_Structure') and !LoginForm.hasRole('Task_Mets_Metadata') and !LoginForm.hasRole('Task_Mets_Files')) and item.benutzerGesperrt == null and ProzessverwaltungForm.modusAnzeige!='vorlagen'}">
																<span class="fa fa-book" />
																<f:param
																	name="nurLesen"
																	value="true" />
																<f:param
																	name="ProzesseID"
																	value="#{item.id}" />
																<f:param
																	name="BenutzerID"
																	value="#{LoginForm.myBenutzer.id}" />
																<f:param
																	name="zurueck"
																	value="process_all" />
															</h:commandLink>

															<!-- METADATA EDITOR - INCL. WRITE -->
															<h:commandLink
																styleClass="btn btn-blank"
																action="#{Metadaten.XMLlesen}"
																id="action15"
																rel="tooltip"
																title="#{msgs.metadatenBearbeiten}"
																pt:data-bs-toggle="tooltip"
																pt:aria-label="#{msgs.metadatenBearbeiten}"
																onclick="preventDoubleSubmit(this);  sessionStorage.removeItem('columnWidths');"
																rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and (LoginForm.hasRole('Task_Mets_Pagination') or LoginForm.hasRole('Task_Mets_Structure') or LoginForm.hasRole('Task_Mets_Metadata') or LoginForm.hasRole('Task_Mets_Files')) and !item.temporaryMetadataFiles}">
																<span class="fa fa-book" />
																<f:param
																	name="ProzesseID"
																	value="#{item.id}" />
																<f:param
																	name="BenutzerID"
																	value="#{LoginForm.myBenutzer.id}" />
																<f:param
																	name="zurueck"
																	value="process_all" />
																<c:if test="#{LoginForm.hasRole('Task_Mets_Files')}">
																	<f:setPropertyActionListener
																		value="File"
																		target="#{Metadaten.modusAnsicht}" />
																</c:if>
																<c:if test="#{LoginForm.hasRole('Task_Mets_Metadata')}">
																	<f:setPropertyActionListener
																		value="Metadaten"
																		target="#{Metadaten.modusAnsicht}" />
																</c:if>
																<c:if test="#{LoginForm.hasRole('Task_Mets_Structure')}">
																	<f:setPropertyActionListener
																		value="Strukturdaten"
																		target="#{Metadaten.modusAnsicht}" />
																</c:if>
																<c:if
																	test="#{LoginForm.hasRole('Task_Mets_Pagination')}">
																	<f:setPropertyActionListener
																		value="Paginierung"
																		target="#{Metadaten.modusAnsicht}" />
																</c:if>
																<f:setPropertyActionListener
																	value="#{null}"
																	target="#{NavigationForm.uiStatus.mets_toc1}" />
																<f:setPropertyActionListener
																	value="#{null}"
																	target="#{NavigationForm.uiStatus.mets_toc2}" />
																<f:setPropertyActionListener
																	value="#{null}"
																	target="#{NavigationForm.uiStatus.mets_toc3}" />
																<f:setPropertyActionListener
																	value="#{null}"
																	target="#{NavigationForm.uiStatus.mets_toc4}" />
																<f:setPropertyActionListener
																	value="#{null}"
																	target="#{NavigationForm.uiStatus.mets_toc5}" />
															</h:commandLink>

															<!--  METADATA MODAL FOR TEMPORARY SAVED DATA  -->
                                                            <button
                                                                jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and (LoginForm.hasRole('Task_Mets_Pagination') or LoginForm.hasRole('Task_Mets_Structure') or LoginForm.hasRole('Task_Mets_Metadata') or LoginForm.hasRole('Task_Mets_Files')) and item.temporaryMetadataFiles}"
                                                                type="button"
                                                                class="btn btn-blank"
                                                                title="#{msgs.metadatenBearbeiten}"
                                                                data-bs-toggle="modal"
                                                                data-bs-target="#myModal-#{item.id}">
                                                              <span class="fa fa-book " />
                                                            </button>

                                                            <!-- MODAL TO BE SHOWN EVENTUALLY -->
                                                            <div
																class="modal fade"
																id="myModal-#{item.id}"
																tabindex="-1"
																role="dialog"
																pt:aria-label="myModalLabel">
																<div
																	class="modal-dialog"
																	role="document">
																	<div class="modal-content">

                                                                        <!-- MODAL HEADER -->
                                                                        <div class="modal-header bg-primary-400 text-white">
                                                                            <h4
                                                                                class="modal-title"
                                                                                id="#{msgs.metseditorOpen}-#{item.id}">
                                                                                <h:outputText
                                                                                    value="#{msgs.metseditorOpen}" />
                                                                            </h4>
                                                                            <button
                                                                                type="button"
                                                                                class="btn-close btn-close-white"
                                                                                data-bs-dismiss="modal"
                                                                                aria-label="Close"></button>
                                                                        </div>
                                                                        <!-- // MODAL HEADER -->

																		 <!-- MODAL BODY -->
                                                                         <div class="modal-body">
																			<h:outputText
																				value="#{msgs.metseditorTemporaryDataExplanation}" />
																				</div>
																		 <!-- // MODAL BODY -->

                                                                         <!-- MODAL FOOTER -->
                                                                         <div class="modal-footer">

																			<h:commandLink
																				onclick="sessionStorage.removeItem('columnWidths');"
																				action="#{Metadaten.XMLlesen}"
																				id="action15a"
																				data-bs-toggle="tooltip"
																				title="#{msgs.discard}"
																				rel="tooltip"
																				styleClass="btn btn-hot">
																				<span class="fa fa-trash-o" />
																				<span>
                                                                                    <h:outputText value="#{msgs.discard}" />
                                                                                </span>
																				<f:param
																					name="ProzesseID"
																					value="#{item.id}" />
																				<f:param
																					name="BenutzerID"
																					value="#{LoginForm.myBenutzer.id}" />
																				<f:param
																					name="zurueck"
																					value="process_all" />
																				<f:param
																					name="discardChanges"
																					value="true" />
																				<f:setPropertyActionListener
																					value="#{null}"
																					target="#{NavigationForm.uiStatus.mets_toc1}" />
																				<f:setPropertyActionListener
																					value="#{null}"
																					target="#{NavigationForm.uiStatus.mets_toc2}" />
																				<f:setPropertyActionListener
																					value="#{null}"
																					target="#{NavigationForm.uiStatus.mets_toc3}" />
																				<f:setPropertyActionListener
																					value="#{null}"
																					target="#{NavigationForm.uiStatus.mets_toc4}" />
																				<f:setPropertyActionListener
																					value="#{null}"
																					target="#{NavigationForm.uiStatus.mets_toc5}" />
																			</h:commandLink>

																			<h:commandLink
																				onclick="sessionStorage.removeItem('columnWidths');"
																				action="#{Metadaten.XMLlesen}"
																				id="action15b"
																				title="#{msgs.overwrite}"
																				data-bs-toggle="tooltip"
																				rel="tooltip"
																				styleClass="btn btn-success">
																				<span class="fa fa-floppy-o" />
																				<span>
                                                                                    <h:outputText value="#{msgs.overwrite}" />
                                                                                </span>
																				<f:param
																					name="ProzesseID"
																					value="#{item.id}" />
																				<f:param
																					name="BenutzerID"
																					value="#{LoginForm.myBenutzer.id}" />
																				<f:param
																					name="zurueck"
																					value="process_all" />
																				<f:param
																					name="overwriteChanges"
																					value="true" />
																				<f:setPropertyActionListener
																					value="#{null}"
																					target="#{NavigationForm.uiStatus.mets_toc1}" />
																				<f:setPropertyActionListener
																					value="#{null}"
																					target="#{NavigationForm.uiStatus.mets_toc2}" />
																				<f:setPropertyActionListener
																					value="#{null}"
																					target="#{NavigationForm.uiStatus.mets_toc3}" />
																				<f:setPropertyActionListener
																					value="#{null}"
																					target="#{NavigationForm.uiStatus.mets_toc4}" />
																				<f:setPropertyActionListener
																					value="#{null}"
																					target="#{NavigationForm.uiStatus.mets_toc5}" />
																			</h:commandLink>
																		</div>
                                                                        <!-- // MODAL FOOTER -->

																	</div>
																</div>
															</div>
                                                            <!-- // MODAL TO BE SHOWN EVENTUALLY -->

															<!-- DMS-EXPORT - ENABLED -->
															<button
																	jsf:action="#{ProzessverwaltungForm.exportDMS}"
																	jsf:id="action21"
																	aria-label="#{!item.containsExportStep ? msgs.noExportTask : msgs.importDms}"
																	jsf:rel="tooltip"
																	onclick="preventDoubleSubmit(this);"
																	title="#{msgs.importDms}"
																	data-bs-toggle="tooltip"
																	class="btn btn-blank"
																	jsf:disabled="#{!item.containsExportStep}"
																	jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and LoginForm.hasRole('Workflow_Processes_Allow_Export') and item.displayDMSButton}">
																	<span class="fa fa-globe" />
																	<x:updateActionListener
																		property="#{ProzessverwaltungForm.myProzess}"
																		value="#{item}" />
																</button>

															<!-- DMS-EXPORT - DISABLED -->
															<div
																jsf:rel="tooltip"
																jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and LoginForm.hasRole('Workflow_Processes_Allow_Export') and !item.displayDMSButton}"
																title="#{!item.containsExportStep ? msgs.noExportTask : ''}"
																data-bs-toggle="tooltip"
																tabindex="0">
																<button
																	jsf:action="#{ProzessverwaltungForm.exportDMS}"
																	jsf:disabled="true"
																	jsf:rel="tooltip"
																	title="#{msgs.importDms}"
																	data-bs-toggle="tooltip"
																	jsf:rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and LoginForm.hasRole('Workflow_Processes_Allow_Export') and !item.displayDMSButton}"
																	class="btn btn-blank">
																	<i class="font-light fa fa-globe" />
																	<x:updateActionListener
																		property="#{ProzessverwaltungForm.myProzess}"
																		value="#{item}" />
																</button>
															</div>

															<!-- CREATE PROCESS - ONE PROJECT -->
															<button
																class="btn #{!ProzesskopieForm.isUserInProcessProject(item) or item.getProjekt().projectIsArchived?'disabled':''} #{item.containsUnreachableSteps?'btn-hot':'btn-primary-400'} button-schaltknopf"
																jsf:action="#{ProzesskopieForm.prepare}"
																jsf:id="action22"
																jsf:rel="tooltip"
																onclick="preventDoubleSubmit(this);"
																data-bs-toggle="tooltip"
																title="#{item.containsUnreachableSteps?msgs.prozessvorlageMitUnvollstaendigenSchrittdetails:
					                                              (item.getProjekt().projectIsArchived ? msgs.projectIsArchived :
					                                              (ProzesskopieForm.isUserInProcessProject(item) ? msgs.eineKopieDieserProzessvorlageAnlegen : msgs.nutzerNichtFuerProjektZugeordnet)
					                                              )
					                                              }"
																jsf:rendered="#{ProzessverwaltungForm.modusAnzeige=='vorlagen' and LoginForm.hasRole('Workflow_ProcessTemplates_Import_Single') and
                                                                ProzesskopieForm.availableProjects.size() eq 1 and ProzesskopieForm.availableProjects.get(0).getTitel() == item.projekt.titel}">
																<span class="fa fa-file-o" />
																<x:updateActionListener
																	property="#{ProzesskopieForm.prozessVorlage}"
																	value="#{item}" />
															</button>

															<!-- CREATE PROCESS - MULTIPLE PROJECTS -->
															<h:panelGroup
																rendered="#{ProzessverwaltungForm.modusAnzeige=='vorlagen' and LoginForm.hasRole('Workflow_ProcessTemplates_Import_Single') and
                                                                (ProzesskopieForm.availableProjects.size() gt 1 or (ProzesskopieForm.availableProjects.size() == 1 and ProzesskopieForm.availableProjects.get(0).getTitel() != item.projekt.titel ) )}">
																<div
																	data-bs-toggle="tooltip"
																	title="#{item.containsUnreachableSteps?msgs.prozessvorlageMitUnvollstaendigenSchrittdetails:
						                                              (item.getProjekt().projectIsArchived ? msgs.projectIsArchived :
						                                              (ProzesskopieForm.isUserInProcessProject(item) ? msgs.eineKopieDieserProzessvorlageAnlegen : msgs.nutzerNichtFuerProjektZugeordnet)
						                                              )
						                                              }">

																	<div class="btn-group position-static">
																		<button
																			jsf:id="copyProcessTempalte"
																			class="btn #{!ProzesskopieForm.isUserInProcessProject(item) or item.getProjekt().projectIsArchived?'disabled':''} #{item.containsUnreachableSteps?'btn-hot':'btn-primary-400'}"
																			aria-label="#{msgs.eineKopieDieserProzessvorlageAnlegen}"
																			data-bs-toggle="tooltip"
																			jsf:action="#{ProzesskopieForm.prepare}"
																			jsf:rel="tooltip">
																			<span class="fa fa-file-o" />
																			<x:updateActionListener
																				property="#{ProzesskopieForm.prozessVorlage}"
																				value="#{item}" />
																		</button>

																		<button
																			type="button"
																			class="btn #{item.containsUnreachableSteps or item.getProjekt().projectIsArchived?'btn-hot':'btn-primary-400'} dropdown-toggle dropdown-toggle-split"
																			data-bs-toggle="dropdown"
																			aria-expanded="false">
																			<span class="visually-hidden">Toggle Dropdown</span>
																		</button>
																		<ul class="dropdown-menu">
																			<ui:repeat
																				var="proj"
																				value="#{ProzesskopieForm.availableProjects}">
																				<li>
																					<button
																						jsf:id="prepare"
																						jsf:action="#{ProzesskopieForm.prepare}"
																						class="dropdown-item">
																						<h:outputText value="#{proj.titel}" />
																						<x:updateActionListener
																							property="#{item.projekt}"
																							value="#{proj}" />
																						<x:updateActionListener
																							property="#{ProzesskopieForm.prozessVorlage}"
																							value="#{item}" />
																					</button>
																				</li>
																			</ui:repeat>
																		</ul>
																	</div>

																</div>
															</h:panelGroup>

															<!-- MASS IMPORT - ONE PROJECT -->
															<button
																class="btn fa #{!ProzesskopieForm.isUserInProcessProject(item) or item.getProjekt().projectIsArchived?'disabled':''} #{item.containsUnreachableSteps?'btn-hot':'btn-primary-400'} button-schaltknopf"
																jsf:action="#{MassImportForm.prepare}"
																jsf:id="action222"
																jsf:rel="tooltip"
																data-bs-toggle="tooltip"
																title="#{item.containsUnreachableSteps?msgs.prozessvorlageMitUnvollstaendigenSchrittdetails:
		                                                        (item.getProjekt().projectIsArchived ? msgs.projectIsArchived :
		                                                        (ProzesskopieForm.isUserInProcessProject(item) ? msgs.MassenImport : msgs.nutzerNichtFuerProjektZugeordnet)
		                                                        )
		                                                        }"
																onclick="preventDoubleSubmit(this);"
																jsf:rendered="#{(ProzessverwaltungForm.modusAnzeige=='vorlagen' and HelperForm.massImportAllowed and LoginForm.hasRole('Workflow_ProcessTemplates_Import_Multi') and
                                                                ProzesskopieForm.availableProjects.size() eq 1 and ProzesskopieForm.availableProjects.get(0).getTitel() == item.projekt.titel)}">
																<span class="fa fa-files-o" />
																<x:updateActionListener
																	property="#{MassImportForm.template}"
																	value="#{item}" />
															</button>

															<!-- MASS IMPORT - MULTIPLE PROJECTS -->
															<h:panelGroup
																rendered="#{(ProzessverwaltungForm.modusAnzeige=='vorlagen' and HelperForm.massImportAllowed and LoginForm.hasRole('Workflow_ProcessTemplates_Import_Multi') and (ProzesskopieForm.availableProjects.size() gt 1
                                                                 or (ProzesskopieForm.availableProjects.size() == 1 and ProzesskopieForm.availableProjects.get(0).getTitel() != item.projekt.titel )))}">
																<div
																	class="dropdown-left"
																	data-bs-toggle="tooltip"
																	title="#{item.containsUnreachableSteps?msgs.prozessvorlageMitUnvollstaendigenSchrittdetails:
			                                                        (item.getProjekt().projectIsArchived ? msgs.projectIsArchived :
			                                                        (ProzesskopieForm.isUserInProcessProject(item) ? msgs.MassenImport : msgs.nutzerNichtFuerProjektZugeordnet)
			                                                        )
			                                                        }">

																	<div class="btn-group position-static">
																		<button
																			jsf:id="massImportPrepare"
																			class="btn fa fa-files-o #{!ProzesskopieForm.isUserInProcessProject(item) or item.getProjekt().projectIsArchived?'disabled':''} #{item.containsUnreachableSteps?'btn-hot':'btn-primary-400'}"
																			aria-label="#{msgs.eineKopieDieserProzessvorlageAnlegen}"
																			data-bs-toggle="tooltip"
																			jsf:action="#{MassImportForm.prepare}"
																			jsf:rel="tooltip">
																			<x:updateActionListener
																				property="#{MassImportForm.template}"
																				value="#{item}" />
																		</button>

																		<button
																			type="button"
																			class="btn #{item.containsUnreachableSteps or item.getProjekt().projectIsArchived?'btn-hot':'btn-primary-400'} dropdown-toggle dropdown-toggle-split"
																			data-bs-toggle="dropdown"
																			aria-expanded="false">
																			<span class="visually-hidden">Toggle Dropdown</span>
																		</button>
																		<ul class="dropdown-menu">
																			<ui:repeat
																				var="proj"
																				value="#{ProzesskopieForm.availableProjects}">
																				<li>
																					<button
																						jsf:action="#{MassImportForm.prepare}"
																						jsf:id="prepare"
																						class="dropdown-item">
																						<h:outputText value="#{proj.titel}" />
																						<x:updateActionListener
																							property="#{item.projekt}"
																							value="#{proj}" />
																						<x:updateActionListener
																							property="#{item.projectId}"
																							value="#{proj.id}" />
																						<x:updateActionListener
																							property="#{MassImportForm.template}"
																							value="#{item}" />
																					</button>
																				</li>
																			</ui:repeat>
																		</ul>
																	</div>
																</div>
															</h:panelGroup>

															<!-- ADDITIONAL OPTIONS AS DROPDOWN -->
															<h:panelGroup
																rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and (LoginForm.hasRole('Workflow_Processes_Allow_Download') or LoginForm.hasRole('Workflow_Processes_Allow_Linking'))}">
																<ui:include src="templatePG/includes/process/list_optionDropdownButton.xhtml" />
															</h:panelGroup>
														</div>
													</td>
												</tr>
											</ui:repeat>
										</table>
									</div>
                                    <!-- // DISPLAY AS TABLE -->


                                    <!-- BUTTON AND PAGINATOR -->
									<div class="box__actions">
										<!-- NEW BUTTON -->
                                        <button
											jsf:action="#{ProzessverwaltungForm.NeuVorlage}"
											jsf:immediate="true"
											class="btn btn-primary-400 me-auto"
											jsf:rendered="#{LoginForm.hasRole('Workflow_General_Details_Edit') and LoginForm.hasRole('Workflow_ProcessTemplates_Create') and ProzessverwaltungForm.modusAnzeige=='vorlagen'}"
											jsf:id="new2">
											<span class="fa fa-plus" />
											<span>
												<h:outputText value="#{msgs.eineNeueProzessvorlageAnlegen}" />
											</span>
										</button>

                                        <!-- PAGINATOR -->
										<div class="dataTables__paginate">
											<intranda:tablePaginator
												paginator="#{ProzessverwaltungForm.paginator}"
												id="navigator" />
										</div>
									</div>
                                    <!-- // BUTTON AND PAGINATOR -->

								</h:form>

							</div>
						</intranda:box>

					</div>
				</div>

				<h:panelGroup
					rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.paginator.list.size() gt 0}">
					<!-- ACTION AREA -->
					<ui:include src="templatePG/includes/process/list_action.xhtml" />
					<!-- COUNTING AREA -->
					<ui:include src="templatePG/includes/process/list_count.xhtml" />
					<!-- STATISTICS AREA -->
					<ui:include src="templatePG/includes/process/list_statistics.xhtml" />
				</h:panelGroup>

			</c:if>

			<!-- JAVASCRIPT -->
			<script type="text/javascript">
		        function showGoobiScriptModal({data, modalID = undefined} = {}) {
					// console.log(modalID);
		            if (!modalID) {
					    return;
				    }
		            if (data.status !== "success") {
						return;
					}
					const element = document.getElementById(modalID);
					if (!element) {
						console.log("Modal not found: " + modalID + "!");
		          		return;
					}

					const mdl = new bootstrap.Modal(element);
					mdl.show();
		        }

				window.onload = function() {
					loadImages();
					// load codemirror for some syntax highlighting
					// initGoobiScriptCodeMirror();
				}

	        	var goobiScriptCodeMirror;
			    function handleGoobiScriptCodeEditor() {
			        removeGoobiScriptCodeMirror();
			        initGoobiScriptCodeMirror();
			    }

	            function removeGoobiScriptCodeMirror() {
	                var codeEditors = document.querySelectorAll('.CodeMirror');
	                codeEditors.forEach(function(editor) { editor.remove() })
	            }

	            function initGoobiScriptCodeMirror() {
	            	var goobiScriptTextArea = document.getElementById("goobiScriptfield");
	            	if(goobiScriptTextArea) {
	                	goobiScriptCodeMirror = CodeMirror.fromTextArea(goobiScriptTextArea, {
							lineNumbers: true,
							mode: 'yaml'
						});
	                	goobiScriptCodeMirror.on('change', editor => {
							document.getElementById("goobiScriptfield").innerHTML = editor.getValue();
					    });
	            	}
	            }

	            jsf.ajax.addOnEvent( function( data ) {
	                var ajaxstatus = data.status;
	                switch ( ajaxstatus ) {
	                    case "success":
	                    	if(data.source.id == "boxProcessesAllActions:expandbutton5") {
	                    		initGoobiScriptCodeMirror();
	                    	}
	                    	loadImages();
	                        break;
	                }
	            });



			</script>
			<!-- // JAVASCRIPT -->

		</main>
	</ui:define>

</ui:composition>
