<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:o="http://omnifaces.org/ui"
    xmlns:of="http://omnifaces.org/functions"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    template="/uii/template/template.html"
    xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites"
    xmlns:editor="http://goobi.io/editor"
    xmlns:form="http://goobi.io/form"
    >

    <ui:param
        name="myPageTitle"
        value="#{goobiScriptTemplateBean.template.id == null?msgs.createNewTemplate:msgs.editTemplate}" />

    <ui:define name="breadcrumb">
        <intranda:breadcrumb
            id="index"
            label="#{DashboardForm.plugin==null?msgs.startseite:msgs.dashboard}"
            action="index"
            navId="a0" />
        <intranda:breadcrumb
            id="templates"
            label="#{msgs.goobiScriptTemplates}"
            action="#{goobiScriptTemplateBean.paginator.returnToPreviousPage}" />
        <intranda:breadcrumb
            id="template"
            label="#{myPageTitle}"
            action="template_edit"
            noSeparator="#{true}" />
    </ui:define>

    <ui:define name="info">
    </ui:define>

    <ui:define name="content">

        <h:form
            id="myform"
            onkeypress="submitOnEnter(event);"
            rendered="#{LoginForm.hasRole('Admin_Templates')}"
            prependId="false">

            <div
                class="row"
                role="main">
                <div class="col-12">

                    <intranda:box
                        id="boxid"
                        boxType="action"
                        boxForm="true"
                        boxPadding="false"
                        title="#{myPageTitle}"
                        icon="fa-clone">
                        <form:field
                            label="#{msgs.name}"
                            help="#{msgs.helptemplateTitle}"
                            required="true">
                            <h:inputText
                                id="title"
                                value="#{goobiScriptTemplateBean.template.title}"
                                styleClass="form-control"
                                required="true" />
                            <form:message target="title" />
                        </form:field>
                        <form:field
                            label="#{msgs.description}"
                            help="#{msgs.helptemplateFile}">
                            <h:inputText
                                id="description"
                                value="#{goobiScriptTemplateBean.template.description}"
                                styleClass="form-control" />
                            <form:message target="description" />
                        </form:field>

                        <form:field
                            label="#{msgs.goobiScript}"
                            help="#{msgs.helptemplateFile}">
                            <editor:code>
                                <h:inputTextarea
                                    id="GoobiScripts"
                                    value="#{goobiScriptTemplateBean.template.goobiScripts}"
                                    pt:data-codemirror-target="true"
                                    pt:data-codemirror-language="yaml"
                                    pt:data-codemirror-update-self="true" />
                            </editor:code>
                        </form:field>


                        <div class="row pt-1">
                            <div class="col-12 min-vh-0">
                                #{msgs.goobiScriptAddToTemplate}
                            </div>
                            <div class="col-12 mb-3">
                                <ui:repeat
                                    var="gs"
                                    value="#{ProzessverwaltungForm.allGoobiScripts}">
                                    <button
                                        class="badge badge-intranda-light"
                                        type="button"
                                        data-codemirror-set="#{gs.two}">
                                        #{gs.one}
                                    </button>
                                </ui:repeat>
                        </div>
                        </div>
                        <intranda:formButtonArea
                            id="buttons"
                            form="#{goobiScriptTemplateBean}"
                            object="#{goobiScriptTemplateBean.template.id}"
                            actionCancel="#{goobiScriptTemplateBean.Cancel}" />
                    </intranda:box>

                </div>
                <!-- /col -->
            </div>
            <!-- /row -->
        </h:form>

    </ui:define>

</ui:composition>
