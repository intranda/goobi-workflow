<ui:component
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:c="http://java.sun.com/jstl/core"
    xmlns:jsf="http://xmlns.jcp.org/jsf"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
>
    <div class="box__title section-header">
        <h2 class="#{collapsible ? 'section-header-collapsible' : ''}">
            <!-- Do not render icon if cc.attrs.icon is undefined -->
            <c:if test="#{icon != null}">
                <span
                    aria-hidden="true"
                    class="fa fa-#{icon}" />
            </c:if>
            <ui:fragment rendered="#{collapsible}">
                <h:commandLink
                    type="button"
                    styleClass="btn"
                    pt:data-bs-toggle="collapse"
                    pt:data-bs-target="##{component.parent.parent.parent.id}_body"
                    pt:aria-expanded="#{!section.isCollapsed(component.parent.parent.parent.clientId, component.parent.parent.parent.attributes['collapsed'])}"
                    pt:aria-controls="##{component.parent.parent.parent.id}_body">
                    <ui:fragment rendered="#{titleId != null}">
                        <span id="#{titleId}">#{title}</span>
                    </ui:fragment>
                    <ui:fragment rendered="#{titleId == null}">
                        #{title}
                    </ui:fragment>
                    <f:ajax listener="#{section.toggle(component.parent.parent.parent.clientId, component.parent.parent.parent.attributes['collapsed'])}" render="@none" />
                </h:commandLink>
            </ui:fragment>
            <ui:fragment rendered="#{not collapsible}">
                <ui:fragment rendered="#{titleId != null}">
                    <span id="#{titleId}">#{title}</span>
                </ui:fragment>
                <ui:fragment rendered="#{titleId == null}">
                    #{title}
                </ui:fragment>
            </ui:fragment>
        </h2>
        <ui:insert />
        <ui:fragment rendered="#{collapsible}">
            <h:commandLink
                type="button"
                styleClass="btn"
                pt:data-bs-toggle="collapse"
                pt:data-bs-target="##{component.parent.parent.parent.id}_body"
                pt:aria-expanded="#{!section.isCollapsed(component.parent.parent.parent.clientId, component.parent.parent.parent.attributes['collapsed'])}"
                pt:aria-controls="##{component.parent.parent.parent.id}_body">
            <span
                class="collapse-caret fa fa-angle-up"
                aria-hidden="true" />
            <span
                class="extend-caret fa fa-angle-down"
                aria-hidden="true" />
            <f:ajax listener="#{section.toggle(component.parent.parent.parent.clientId, component.parent.parent.parent.attributes['collapsed'])}" render="@none" />
            </h:commandLink>
        </ui:fragment>
    </div>
</ui:component>