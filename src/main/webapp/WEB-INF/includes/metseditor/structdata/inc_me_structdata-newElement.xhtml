<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:composite="http://xmlns.jcp.org/jsf/composite"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:intranda="http://xmlns.jcp.org/jsf/composite/compositesPG"
    xmlns:jsf="http://xmlns.jcp.org/jsf"
    xmlns:p="http://primefaces.org/ui"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:section="http://goobi.io/section"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <composite:interface/>

    <composite:implementation>
        <div id="meStructdataNewElementBox" class="pb-3">
            <section:section type="neutral">
                <section:header icon="bars" title="#{msgs.neuesStrukturelement}">
                    <section:header-actions>
                        <button aria-label="#{msgs.minimizeBox}" type="button" class="btn" data-bs-toggle="collapse" data-bs-target="#newElementBoxBody" aria-expanded="true" aria-controls="newElementBoxBody">
                            <span class="collapse-caret fa fa-angle-up" aria-hidden="true"/>
                            <span class="extend-caret fa fa-angle-down" aria-hidden="true"/>
                        </button>
                    </section:header-actions>
                </section:header>
                <div id="newElementBoxBody" class="collapse show">
                    <section:body>
                        <h:panelGroup id="struct" layout="block">
                            <div class="p-3 border-bottom">
                                <!-- PLACEMENT SELECTION -->
                                <h:selectOneRadio id="auswahlElementWohin" styleClass="select-radio focusableChildCss" forceId="true" layout="pageDirection" value="#{Metadaten.neuesElementWohin}">
                                    <f:selectItem itemValue="1" itemLabel="#{msgs.vorDasAktuelleElement}"/>
                                    <f:selectItem itemValue="2" itemLabel="#{msgs.hinterDasAktuelleElement}"/>
                                    <f:selectItem itemValue="3" itemLabel="#{msgs.alsErstesKindDesAktuellenElements}"/>
                                    <f:selectItem itemValue="4" itemLabel="#{msgs.alsLetztesKindDesAktuellenElements}"/>
                                    <f:ajax render="struct" event="change" execute="struct"/>
                                </h:selectOneRadio>
                            </div>
                            <!-- PREVIOUS PAGE -->
                            <div class="structdata__previous-page form-row">
                                <div class="form-label">
                                    <label for="pagestart1">#{msgs.ersteSeite}:</label>
                                </div>
                                <div class="form-input">
                                    <p:autoComplete pt:aria-label="#{msgs.firstPage}" scrollHeight="300" id="pagestart1" styleClass="form-control" inputStyleClass="border-0 w-100 p-0" value="#{Metadaten.pagesStart}" completeMethod="#{Metadaten.autocomplete}"/>
                                    <button jsf:id="takePreviousImage" aria-label="#{msgs.previousImage}" class="btn btn--icon-white" jsf:action="#{Metadaten.CurrentStartpage}" title="#{msgs.mets_takePreviousImage}" type="button">
                                        <span class="fa fa-angle-left fa-lg" aria-hidden="true"/>
                                        <f:setPropertyActionListener value="#{Metadaten.imageIndex}" property="#{Metadaten.pageNumber}" target="#{Metadaten.pageNumber}"/>
                                        <f:passThroughAttribute name="data-toggle" value="tooltip"/>
                                        <f:ajax render="pagestart1"/>
                                    </button>
                                    <button jsf:id="takeCurrentImage" aria-label="#{msgs.lw_currentImage}" class="btn btn--icon-gray" jsf:action="#{Metadaten.CurrentStartpage}" title="#{msgs.mets_takeCurrentImage}" type="button">
                                        <span class="fa fa-picture-o" aria-hidden="true"/>
                                        <f:setPropertyActionListener value="#{Metadaten.imageIndex+1}" property="#{Metadaten.pageNumber}" target="#{Metadaten.pageNumber}"/>
                                        <f:passThroughAttribute name="data-toggle" value="tooltip"/>
                                        <f:ajax render="pagestart1"/>
                                    </button>
                                    <button jsf:id="takeNextImage" aria-label="#{msgs.nextImage}" class="btn btn--icon-white" jsf:action="#{Metadaten.CurrentStartpage}" title="#{msgs.mets_takeNextImage}" type="button">
                                        <span class="fa fa-angle-right fa-lg" aria-hidden="true"/>
                                        <f:setPropertyActionListener value="#{Metadaten.imageIndex+2}" property="#{Metadaten.pageNumber}" target="#{Metadaten.pageNumber}"/>
                                        <f:passThroughAttribute name="data-toggle" value="tooltip"/>
                                        <f:ajax render="pagestart1"/>
                                    </button>
                                </div>
                            </div>
                            <!-- LAST PAGE -->
                            <div class="form-row structdata__last-page">
                                <div class="form-label">
                                    <label for="pageend1">#{msgs.letzteSeite}:</label>
                                </div>
                                <div class="form-input">
                                    <p:autoComplete scrollHeight="300" id="pageend1" pt:aria-label="#{msgs.lastPage}" styleClass="form-control" inputStyleClass="border-0 w-100 p-0" forceId="true" value="#{Metadaten.pagesEnd}" completeMethod="#{Metadaten.autocomplete}"/>
                                    <button jsf:id="takePreviousImage2" aria-label="#{msgs.previousImage}" class="btn btn--icon-white" jsf:action="#{Metadaten.CurrentEndpage}" title="#{msgs.mets_takePreviousImage}" type="button">
                                        <span class="fa fa-angle-left fa-lg" aria-hidden="true"/>
                                        <f:setPropertyActionListener value="#{Metadaten.imageIndex}" property="#{Metadaten.pageNumber}" target="#{Metadaten.pageNumber}"/>
                                        <f:passThroughAttribute name="data-toggle" value="tooltip"/>
                                        <f:ajax render="pageend1"/>
                                    </button>
                                    <button jsf:id="takeCurrentImage2" aria-label="#{msgs.lw_currentImage}" class="btn btn--icon-gray" jsf:action="#{Metadaten.CurrentEndpage}" title="#{msgs.mets_takeCurrentImage}" type="button">
                                        <span class="fa fa-picture-o" aria-hidden="true"/>
                                        <f:setPropertyActionListener value="#{Metadaten.imageIndex +1}" property="#{Metadaten.pageNumber}" target="#{Metadaten.pageNumber}"/>
                                        <f:passThroughAttribute name="data-toggle" value="tooltip"/>
                                        <f:ajax render="pageend1"/>
                                    </button>
                                    <button jsf:id="takeNextImage2" aria-label="#{msgs.nextImage}" class="btn btn--icon-white" jsf:action="#{Metadaten.CurrentEndpage}" title="#{msgs.mets_takeNextImage}" type="button">
                                        <span class="fa fa-angle-right fa-lg" aria-hidden="true"/>
                                        <f:setPropertyActionListener value="#{Metadaten.imageIndex +2}" property="#{Metadaten.pageNumber}" target="#{Metadaten.pageNumber}"/>
                                        <f:passThroughAttribute name="data-toggle" value="tooltip"/>
                                        <f:ajax render="pageend1"/>
                                    </button>
                                </div>
                            </div>
                            <h:panelGroup id="addNewPageArea" styleClass="form-row structdata__page-area" layout="block" rendered="#{Metadaten.enablePageArea}">
                                <div class="form-label">
                                    <label for="pageArea">#{msgs.pageArea}:</label>
                                </div>
                                <div class="form-input">
                                    <h:inputText id="pageAreaName" pt:aria-label="#{msgs.pageArea}" styleClass="form-control focusableChildCss" value="#{Metadaten.pageArea}" disabled="true"/>
                                        <ui:fragment rendered="#{(Metadaten.neuesElementWohin gt 2 and not empty Metadaten.addDocStructType2) or (Metadaten.neuesElementWohin lt 3 and not empty Metadaten.addDocStructType1)}">
                                <!-- ADD PAGE AREA -->
                                    <button class="btn btn--icon-gray start-area-edition" title="#{msgs.mets_createPageArea}" type="button" onclick="goobiWorkflowJS.object.startDrawArea(this, 'new')" aria-label="#{msgs.mets_createPageArea}" data-toggle="tooltip" data-placement="top">
                                        <span class="fa fa-crop" aria-hidden="true"/>
                                    </button>
                                    <button class="btn btn--icon-red cancel-area-edition" title="#{msgs.mets_cancelPageArea}" type="button" onclick="goobiWorkflowJS.object.cancelDrawArea(this)" aria-label="#{msgs.mets_cancelPageArea}" data-toggle="tooltip" data-placement="top">
                                        <span class="fa fa-ban" aria-hidden="true"/>
                                    </button>
                                    </ui:fragment>
                                </div>
                            </h:panelGroup>
                            <!-- STRUCTURE TYPE -->
                            <div class="form-row structdata__structure-type">
                                <div class="form-label">
                                    <ui:fragment rendered="#{Metadaten.neuesElementWohin lt 3}">
                                        <label for="auswahlAddable1">#{msgs.typ}:</label>
                                    </ui:fragment>
                                    <ui:fragment rendered="#{Metadaten.neuesElementWohin gt 2}">
                                        <label for="auswahlAddable2">#{msgs.typ}:</label>
                                    </ui:fragment>
                                </div>
                                <div class="form-input">
                                    <h:selectOneMenu id="auswahlAddable1" forceId="true" value="#{Metadaten.addDocStructType1}" rendered="#{Metadaten.neuesElementWohin lt 3}" styleClass="form-select">
                                        <f:selectItems value="#{Metadaten.addableDocStructTypenAlsNachbar}" itemLabel="#{item.label}" itemValue="#{item.value.name}" var="item"/>
                                        <f:ajax render="struct" event="change" execute="struct"/>
                                    </h:selectOneMenu>
                                    <h:selectOneMenu id="auswahlAddable2" styleClass="form-select" forceId="true" value="#{Metadaten.addDocStructType2}" rendered="#{Metadaten.neuesElementWohin gt 2}">
                                        <f:selectItems value="#{Metadaten.addableDocStructTypenAlsKind}" itemLabel="#{item.label}" itemValue="#{item.value.name}" var="item"/>
                                        <f:ajax render="struct" event="change" execute="struct"/>
                                </h:selectOneMenu>
                                </div>
                            </div>

                            <!-- ADD ABLE PERSONDATA -->
                            <h:panelGroup rendered="#{Metadaten.addablePersondata.size() &gt; 0}">
                                <ui:repeat id="addablePersondata" var="addablePersondata" value="#{Metadaten.addablePersondata}">
                                    <intranda:formGroupPerson id="person" person="#{addablePersondata}" renderDelete="false" datatype="addablePerson"/>
                                </ui:repeat>
                            </h:panelGroup>

                            <!-- ADD ABLE METADATA -->
                            <ui:fragment rendered="#{Metadaten.addableMetadata.size() &gt; 0}">
                                <ui:repeat id="addableMetadata" var="Item" value="#{Metadaten.addableMetadata}">
                                    <intranda:formGroupMetadata cols="2" metadata="#{Item}" datatype="addableMetadata" renderDelete="false" renderDuplicate="false" />
                                </ui:repeat>
                            </ui:fragment>

                            <!-- ADD ELEMENT -->
                            <section:footer>
                                <button jsf:id="fastPagination" class="btn btn-blank" type="button">
                                    <span class="fa #{Metadaten.enableFastPagination == false?'fa fa-square-o':'fa fa-check-square-o'}" aria-hidden="true"/>
                                    <h:outputText value="#{msgs.mets_easyPagination}" styleClass="structdata__easyPagination"/>
                                    <f:setPropertyActionListener value="#{not Metadaten.enableFastPagination}" target="#{Metadaten.enableFastPagination}"/>
                                    <f:ajax onevent="data =&gt; goobiWorkflowJS.meScrollPos.init(data)" render=":pageContentCenter"/>
                                </button>
                                <button jsf:id="add" class="btn btn-blank" jsf:action="#{Metadaten.KnotenAdd}">
                                    #{msgs.strukturelementHinzufuegen}
                                    <f:ajax render="@form :treeform :messages :openseadragonform:pageareas" execute="@form"/>
                                </button>
                            </section:footer>
                        </h:panelGroup>
                    </section:body>
                </div>
            </section:section>
        </div>
    </composite:implementation>
</ui:composition>