<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:composite="http://xmlns.jcp.org/jsf/composite"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:x="http://myfaces.apache.org/tomahawk"
    xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:jsf="http://xmlns.jcp.org/jsf">

    <composite:interface>
    </composite:interface>

    <composite:implementation>
		<link rel="stylesheet" href="template/css/codemirror/codemirror.css?v=#{HelperForm.buildVersion}"/>
        <script type="text/javascript" src="template/js/codemirror/codemirror.js?v=#{HelperForm.buildVersion}"/>
    	<script src="template/js/codemirror/mode/yaml/yaml.js?v=#{HelperForm.buildVersion}"/>

    	<style>
	        .CodeMirror{
				border: 1px solid #ddd;
				height:100px;
			}
	    </style>

        <h:panelGroup rendered="#{ProzessverwaltungForm.modusBearbeiten!='schritt'}">

            <div class="box box-color box-bordered">
                <div class="box-title">
                    <h2 class="tableColumnMaxWidthExtraLong">
                        <span class="fa fa-table" />
                        <h:outputText value="#{msgs.schrittDetails}" />
                        <h:outputText
                            value=" - #{ProzessverwaltungForm.myProzess.titel}"
                            rendered="#{ProzessverwaltungForm.myProzess.id != null}" />
                    </h2>

                    <div class="actions">

                        <button
                            jsf:id="reloadStep"
                            aria-label="#{msgs.reload}"
                            jsf:action="#{ProzessverwaltungForm.reload}"
                            class="btn btn-mini"
                            title="#{msgs.reload}"
                            jsf:rel="tooltip">
                            <span class="fa fa-refresh" />
                            <f:passThroughAttribute
                                name="data-toggle"
                                value="tooltip" />
                        </button>

                        <button
                            jsf:id="editStep"
                            title="#{msgs.bearbeiten}"
                            aria-label="#{msgs.bearbeiten}"
                            jsf:action="#{NavigationForm.Reload}"
                            jsf:rendered="#{LoginForm.hasRole('Workflow_General_Details_Edit')}"
                            class="btn btn-mini"
                            jsf:rel="tooltip">
                            <span class="fa fa-pencil" />
                            <f:passThroughAttribute
                                name="data-toggle"
                                value="tooltip" />
                            <x:updateActionListener
                                property="#{ProzessverwaltungForm.modusBearbeiten}"
                                value="schritt" />
                        </button>
                    </div>

                </div>
                <div class="box-content nopadding">

                    <h:panelGrid
                        columns="2"
                        styleClass="table table-hover table-bordered">
                        <h:outputText value="#{msgs.titel}:" />
                        <span
                            title="#{ProzessverwaltungForm.mySchritt.titel}"
                            data-toggle="tooltip">#{ProzessverwaltungForm.mySchritt.titelLokalisiert}</span>

                        <h:outputText value="#{msgs.id}:" />
                        <h:outputText value="#{ProzessverwaltungForm.mySchritt.id}" />

                        <h:outputText value="#{msgs.reihenfolge}:" />
                        <h:outputText value="#{ProzessverwaltungForm.mySchritt.reihenfolge}" />

                        <h:outputText value="#{msgs.prioritaet}:" />
                        <h:panelGroup>
                            <h:panelGroup rendered="#{ProzessverwaltungForm.mySchritt.prioritaet == 0}">
                                <span class="badge badge-intranda-ultralight"> #{msgs.normalePrioritaet} </span>
                            </h:panelGroup>

                            <h:panelGroup rendered="#{ProzessverwaltungForm.mySchritt.prioritaet == 1}">
                                <span class="badge badge-intranda-orange"> <span class="fa fa-lightbulb-o" /> #{msgs.badgePriority1}
                                </span>
                            </h:panelGroup>

                            <h:panelGroup rendered="#{ProzessverwaltungForm.mySchritt.prioritaet == 2}">
                                <span class="badge badge-intranda-orange"> <span class="fa fa-lightbulb-o" /> #{msgs.badgePriority2}
                                </span>
                            </h:panelGroup>

                            <h:panelGroup
                                rendered="#{ProzessverwaltungForm.mySchritt.prioritaet gt 2 and ProzessverwaltungForm.mySchritt.prioritaet lt 10}">
                                <span class="badge badge-intranda-orange"> <span class="fa fa-lightbulb-o" /> #{msgs.badgePriority3}
                                </span>
                            </h:panelGroup>

                            <h:panelGroup rendered="#{ProzessverwaltungForm.mySchritt.prioritaet gt 9}">
                                <span class="badge badge-intranda-red"> <span class="fa fa-bullhorn" /> #{msgs.badgeCorrection}
                                </span>
                            </h:panelGroup>
                        </h:panelGroup>

                        <h:outputText value="#{msgs.typ}:" rendered="#{ProzessverwaltungForm.mySchritt.typeSpecified}" />
                        <h:panelGroup rendered="#{ProzessverwaltungForm.mySchritt.typeSpecified}">
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.metadaten}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typMetadaten}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.importMittelsFileUpload}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typImportFileUpload}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.exportDMS}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typExportDMS}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.schrittBeimAnnehmenAbschliessen}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typBeimAnnehmenAbschliessen}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.beimAnnehmenModulStarten}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typBeimAnnehmenModul}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.beimAnnehmenModulStartenUndSchrittAbschliessen}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typBeimAnnehmenModulUndAbschliessen}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.imagesLesen}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typImagesLesen}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.imagesSchreiben}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typImagesSchreiben}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.beimAbschliessenVerifizieren}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typBeimAbschliessenVerifizieren}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.automatischerSchritt}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typAutomatisch}" />
                             <h:outputText
                                styleClass="block"
                                value="#{msgs.typeThumbnailStep}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typAutomaticThumbnail}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.typScriptStep}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typScriptStep}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.modulSchritt}: #{ProzessverwaltungForm.mySchritt.typModulName}"
                                rendered="#{ProzessverwaltungForm.mySchritt.typModulName!=null and ProzessverwaltungForm.mySchritt.typModulName!=''}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.stepPlugin}: #{ProzessverwaltungForm.mySchritt.stepPlugin}"
                                rendered="#{ProzessverwaltungForm.mySchritt.stepPlugin!=null and ProzessverwaltungForm.mySchritt.stepPlugin!=''}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.validationPlugin}"
                                rendered="#{ProzessverwaltungForm.mySchritt.validationPlugin!=null and ProzessverwaltungForm.mySchritt.validationPlugin!=''}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.timeDelayPlugin}"
                                rendered="#{ProzessverwaltungForm.mySchritt.delayStep!=null and ProzessverwaltungForm.mySchritt.delayStep!='' and ProzessverwaltungForm.mySchritt.delayStep}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.batchStep}"
                                rendered="#{ProzessverwaltungForm.mySchritt.batchStep}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.updateMetadataIndex}"
                                rendered="#{ProzessverwaltungForm.mySchritt.updateMetadataIndex}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.process_generateDocket}"
                                rendered="#{ProzessverwaltungForm.mySchritt.generateDocket}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs.httpStep}"
                                rendered="#{ProzessverwaltungForm.mySchritt.httpStep}" />
                            <h:outputText
                                styleClass="block"
                                value="#{msgs['queue_'.concat(ProzessverwaltungForm.mySchritt.messageQueue.toString())]}"
                                rendered="#{ProzessverwaltungForm.mySchritt.messageQueue ne 'NONE'}" />
                        </h:panelGroup>

                        <h:outputText
                            value="#{msgs.script}:"
                            rendered="#{ProzessverwaltungForm.mySchritt.typScriptStep and not empty ProzessverwaltungForm.mySchritt.allScriptPaths}" />
                        <h:panelGroup rendered="#{ProzessverwaltungForm.mySchritt.typScriptStep and not empty ProzessverwaltungForm.mySchritt.allScriptPaths}">
                            <h:panelGroup styleClass="block">
                                <h:outputText
                                    id="nameautomatisch"
                                    value="#{ProzessverwaltungForm.mySchritt.scriptname1}" />
                                <h:outputText
                                    id="txtautomatisch"
                                    styleClass="font-light "
                                    value=" #{ProzessverwaltungForm.mySchritt.typAutomatischScriptpfad}" />
                            </h:panelGroup>

                            <h:panelGroup styleClass="block">
                                <h:outputText
                                    id="nameautomatisch2"
                                    value="#{ProzessverwaltungForm.mySchritt.scriptname2}" />
                                <h:outputText
                                    id="txtautomatisch2"
                                    styleClass="font-light "
                                    value=" #{ProzessverwaltungForm.mySchritt.typAutomatischScriptpfad2}" />
                            </h:panelGroup>

                            <h:panelGroup styleClass="block">
                                <h:outputText
                                    id="nameautomatisch3"
                                    value="#{ProzessverwaltungForm.mySchritt.scriptname3}" />
                                <h:outputText
                                    id="txtautomatisch3"
                                    styleClass="font-light "
                                    value=" #{ProzessverwaltungForm.mySchritt.typAutomatischScriptpfad3}" />
                            </h:panelGroup>

                            <h:panelGroup styleClass="block">
                                <h:outputText
                                    id="nameautomatisch4"
                                    value="#{ProzessverwaltungForm.mySchritt.scriptname4}" />
                                <h:outputText
                                    id="txtautomatisch4"
                                    styleClass="font-light "
                                    value=" #{ProzessverwaltungForm.mySchritt.typAutomatischScriptpfad4}" />
                            </h:panelGroup>

                            <h:panelGroup styleClass="block">
                                <h:outputText
                                    id="nameautomatisch5"
                                    value="#{ProzessverwaltungForm.mySchritt.scriptname5}" />
                                <h:outputText
                                    id="txtautomatisch5"
                                    styleClass="font-light "
                                    value=" #{ProzessverwaltungForm.mySchritt.typAutomatischScriptpfad5}" />
                            </h:panelGroup>

                        </h:panelGroup>

                        <h:outputText value="#{msgs.status}:" />
                        <h:panelGroup>
                            <ul class="colors small13">
                                <li
                                    class="#{(LoginForm.myBenutzer.uiMode=='low_vision'?('easy-read-'):('')).concat(ProzessverwaltungForm.mySchritt.bearbeitungsstatusEnum.color)} margin-top-lesser margin-right-regular"
                                    rel="tooltip"
                                    title="#{ProzessverwaltungForm.mySchritt.bearbeitungsstatusEnum.title}" />
                            </ul>
                            <h:outputText value="#{ProzessverwaltungForm.mySchritt.bearbeitungsstatusEnum.title}" />
                        </h:panelGroup>

                    </h:panelGrid>
                </div>
            </div>

        </h:panelGroup>

        <!-- Box für die Bearbeitung der Details -->
        <h:panelGroup rendered="#{ProzessverwaltungForm.modusBearbeiten=='schritt'}">


            <div class="box box-color orange box-bordered">
                <div class="box-title">
                    <h2 class="tableColumnMaxWidthExtraLong">
                        <span class="fa fa-table" />
                        <h:outputText value="#{msgs.details}" />
                        <h:outputText
                            value="  - #{ProzessverwaltungForm.myProzess.titel}"
                            rendered="#{ProzessverwaltungForm.myProzess.id != null}" />
                    </h2>
                </div>
                <div class="box-content nopadding">
                    <!-- Felder -->

                    <intranda:formInputText
                        id="title"
                        name="titel2"
                        label="#{msgs.titel}"
                        field="#{ProzessverwaltungForm.mySchritt.titel}"
                        help="#{msgs.helpProcessStepTitle}"
                        required="true" />

                    <intranda:formInputText
                        id="order"
                        name="reihenfolge2"
                        label="#{msgs.reihenfolge}"
                        field="#{ProzessverwaltungForm.mySchritt.reihenfolge}"
                        help="#{msgs.helpProcessStepOrder}"
                        required="true" />
					<intranda:formInputCheckBox
                        id="allowParallelTask"
                        label="#{msgs.allowParallelTask}"
                        field="#{ProzessverwaltungForm.createNewStepAllowParallelTask}"
                        help="#{msgs.helpProcessStepAllowParallelTask}"
                        name="allowParallelTask"
                        rendered="#{ProzessverwaltungForm.mySchritt.id == null}" />

                    <intranda:formInputDropDown
                        id="priority"
                        label="#{msgs.prioritaet}"
                        field="#{ProzessverwaltungForm.mySchritt.prioritaet}"
                        help="#{msgs.helpProcessStepPriority}"
                        name="prioritaet"
                        selectItems="#{HelperForm.stepPriorityList}"
                        required="true" />

                    <intranda:formInputCheckBox
                        id="metadata"
                        label="#{msgs.metadaten}"
                        field="#{ProzessverwaltungForm.mySchritt.typMetadaten}"
                        help="#{msgs.helpProcessStepMetadata}"
                        name="metadataname" />

                    <intranda:formInputCheckBox
                        id="readImages"
                        label="#{msgs.imagesLesen}"
                        field="#{ProzessverwaltungForm.mySchritt.typImagesLesen}"
                        help="#{msgs.helpProcessStepReadImages}"
                        name="chkLesen" />

                    <!-- TODO Javascript onclick="if(this.checked) document.getElementById('chkLesen').checked=true;" -->
                    <intranda:formInputCheckBox
                        id="writeImages"
                        label="#{msgs.imagesSchreiben}"
                        field="#{ProzessverwaltungForm.mySchritt.typImagesSchreiben}"
                        help="#{msgs.helpProcessStepWriteImages}"
                        name="chkSchreiben" />

                    <intranda:formInputCheckBox
                        id="verify"
                        label="#{msgs.beimAbschliessenVerifizieren}"
                        field="#{ProzessverwaltungForm.mySchritt.typBeimAbschliessenVerifizieren}"
                        help="#{msgs.helpProcessStepVerify}"
                        name="verifyname" />

                    <intranda:formInputCheckBox
                        id="exportDMS"
                        label="#{msgs.exportDMS}"
                        field="#{ProzessverwaltungForm.mySchritt.typExportDMS}"
                        help="#{msgs.helpProcessStepExport}"
                        name="export" />

                    <intranda:formInputCheckBox
                        id="schrittBeimAnnehmenAbschliessen"
                        label="#{msgs.schrittBeimAnnehmenAbschliessen}"
                        field="#{ProzessverwaltungForm.mySchritt.typBeimAnnehmenAbschliessen}"
                        help="#{msgs.helpProcessStepFinish}"
                        name="chkmanuell1" />

                    <h:panelGroup rendered="#{false}">
                        <intranda:formInputCheckBox
                            id="beimAnnehmenModulStarten"
                            label="#{msgs.beimAnnehmenModulStarten}"
                            field="#{ProzessverwaltungForm.mySchritt.typBeimAnnehmenModul}"
                            help="#{msgs.helpProcessStepStartModule}"
                            name="chkmanuell2" />

                        <intranda:formInputCheckBox
                            id="beimAnnehmenModulStartenUndSchrittAbschliessen"
                            label="#{msgs.beimAnnehmenModulStartenUndSchrittAbschliessen}"
                            field="#{ProzessverwaltungForm.mySchritt.typBeimAnnehmenModulUndAbschliessen}"
                            help="#{msgs.helpProcessStepStartModuleAndFinish}"
                            name="chkmanuell3" />

                    </h:panelGroup>

                    <div
                        class="form-group"
                        style="">
                        <h:outputLabel
                            for="automatic"
                            styleClass="control-label col-sm-3"
                            value="#{msgs.automatischerSchritt}" />
                        <div class="col-sm-9">

                            <x:selectBooleanCheckbox
                                forceId="true"
                                style="display:block; margin-bottom:10px;"
                                id="automatic"
                                onclick="txtAutomatischAnzeigen()"
                                value="#{ProzessverwaltungForm.mySchritt.typAutomatisch}" />
                            <h:message
                                for="automatic"
                                showDetail="true"
                                styleClass="help-inline font-danger" />
                            <intranda:formHelp content="#{msgs.helpProcessStepAutomatic}" />

                            <span id="messageQueueDropDown"> <h:selectOneMenu
                                    id="messageQueue"
                                    pt:aria-label="#{msgs.messageQueue}"
                                    styleClass="form-control"
                                    value="#{ProzessverwaltungForm.mySchritt.messageQueue}"
                                    tabindex="0">
                                    <!-- 					<f:selectItem itemValue="" itemLabel="#{msgs.bitteAuswaehlen}" itemDisabled="true"/> -->
                                    <f:selectItems
                                        value="#{ProzessverwaltungForm.possibleMessageQueues}"
                                        var="item"
                                        itemLabel="#{msgs['queue_'.concat(item.toString())]}" />
                                </h:selectOneMenu> <h:message
                                    for="messageQueue"
                                    showDetail="true"
                                    styleClass="help-inline font-danger" />
                                <intranda:formHelp content="#{msgs.helpMessageQueueSelection}" />
                            </span>
                        </div>
                    </div>

                    <!-- help is still wrong -->
                    <div class="form-group" style="">
                    	<h:outputLabel
                            for="autoThumbnail"
                            styleClass="control-label col-sm-3"
                            value="#{msgs.typeThumbnailStep}" />
                    	<div class="col-sm-9">
		                    <x:selectBooleanCheckbox
		                    	forceId="true"
		                        id="autoThumbnail"
		                        onclick="showThumbsSettings()"
		                        value="#{ProzessverwaltungForm.mySchritt.typAutomaticThumbnail}"
		                        />
                            <h:message
                                for="autoThumbnail"
                                showDetail="true"
                                styleClass="help-inline font-danger" />
                            <intranda:formHelp content="#{msgs.helpProcessStepAutomaticThumbnail}" />

		                    <span id="thumbsSettings">
		                    	<h:inputTextarea
			                        id="ThumbSettings"
			                        forceId="true"
			                        value="#{ProzessverwaltungForm.mySchritt.automaticThumbnailSettingsYaml}"
			                        styleClass="form-control"
			                        required="false" />
	                    	</span>
	                    </div>
	                </div>

                    <div
                        class="form-group"
                        style="">
                        <h:outputLabel
                            for="chkautomatisch"
                            styleClass="control-label col-sm-3"
                            value="#{msgs.ScriptSchritt}" />
                        <div class="col-sm-9">

                            <x:selectBooleanCheckbox
                                forceId="true"
                                style="display:block; margin-bottom:10px;"
                                id="chkautomatisch"
                                onclick="txtAutomatischAnzeigen()"
                                value="#{ProzessverwaltungForm.mySchritt.typScriptStep}" />

                            <h:message
                                for="chkautomatisch"
                                showDetail="true"
                                styleClass="help-inline font-danger" />
                            <intranda:formHelp content="#{msgs.helpProcessScripts}" />

                            <x:panelGrid
                                columns="2"
                                forceId="true"
                                id="scripttable"
                                style="display:block; margin-top:10px;">

                                <h:outputText
                                    id="scriptname"
                                    value="#{msgs.scriptname}" />

                                <h:outputText
                                    id="scrpitpfad"
                                    value="#{msgs.scriptpath}"
                                    styleClass="margin-left-10" />

                                <x:inputText
                                    id="nameautomatisch"
                                    pt:aria-label="#{msgs.scriptname}"
                                    forceId="true"
                                    styleClass="form-control"
                                    value="#{ProzessverwaltungForm.mySchritt.scriptname1}" />

                                <x:inputText
                                    id="txtautomatisch"
                                    pt:aria-label="#{msgs.scriptpath}"
                                    forceId="true"
                                    styleClass="form-control margin-left-10 width-600"
                                    value="#{ProzessverwaltungForm.mySchritt.typAutomatischScriptpfad}" />


                                <x:inputText
                                    id="nameautomatisch2"
                                    pt:aria-label="#{msgs.scriptname}"
                                    forceId="true"
                                    styleClass="form-control margin-top-5 "
                                    value="#{ProzessverwaltungForm.mySchritt.scriptname2}" />
                                <x:inputText
                                    id="txtautomatisch2"
                                    pt:aria-label="#{msgs.scriptpath}"
                                    forceId="true"
                                    styleClass="form-control margin-top-5 margin-left-10 width-600"
                                    value="#{ProzessverwaltungForm.mySchritt.typAutomatischScriptpfad2}" />

                                <x:inputText
                                    id="nameautomatisch3"
                                    pt:aria-label="#{msgs.scriptname}"
                                    forceId="true"
                                    styleClass="form-control margin-top-5 "
                                    value="#{ProzessverwaltungForm.mySchritt.scriptname3}" />
                                <x:inputText
                                    id="txtautomatisch3"
                                    pt:aria-label="#{msgs.scriptpath}"
                                    forceId="true"
                                    styleClass="form-control margin-top-5 margin-left-10 width-600"
                                    value="#{ProzessverwaltungForm.mySchritt.typAutomatischScriptpfad3}" />

                                <x:inputText
                                    id="nameautomatisch4"
                                    pt:aria-label="#{msgs.scriptname}"
                                    forceId="true"
                                    styleClass="form-control margin-top-5 "
                                    value="#{ProzessverwaltungForm.mySchritt.scriptname4}" />
                                <x:inputText
                                    id="txtautomatisch4"
                                    pt:aria-label="#{msgs.scriptpath}"
                                    forceId="true"
                                    styleClass="form-control margin-top-5 margin-left-10 width-600"
                                    value="#{ProzessverwaltungForm.mySchritt.typAutomatischScriptpfad4}" />

                                <x:inputText
                                    id="nameautomatisch5"
                                    pt:aria-label="#{msgs.scriptname}"
                                    forceId="true"
                                    styleClass="form-control margin-top-5 "
                                    value="#{ProzessverwaltungForm.mySchritt.scriptname5}" />
                                <x:inputText
                                    id="txtautomatisch5"
                                    pt:aria-label="#{msgs.scriptpath}"
                                    forceId="true"
                                    styleClass="form-control margin-top-5 margin-left-10 width-600"
                                    value="#{ProzessverwaltungForm.mySchritt.typAutomatischScriptpfad5}" />


                            </x:panelGrid>
                            <x:message
                                for="chkautomatisch"
                                style="color: red"
                                replaceIdWithLabel="true" />
                        </div>
                    </div>

                    <h:panelGroup
                        layout="block"
                        class="form-group"
                        style=""
                        id="httpControls">
                        <h:outputLabel
                            for="chkhttp"
                            styleClass="control-label col-sm-3"
                            value="#{msgs.HttpSchritt}" />
                        <div class="col-sm-9">

                            <h:selectBooleanCheckbox
                                style="display:block; margin-bottom:10px;"
                                id="chkhttp"
                                value="#{ProzessverwaltungForm.mySchritt.httpStep}">
                                <f:ajax
                                    event="click"
                                    render="myform:httpControls"
                                    execute="@this" />
                            </h:selectBooleanCheckbox>
                            <h:message
                                for="chkhttp"
                                showDetail="true"
                                styleClass="help-inline font-danger" />
                            <intranda:formHelp content="#{msgs.helpHttpStep}" />


                            <ui:fragment rendered="#{ProzessverwaltungForm.mySchritt.httpStep}">
                                <div
                                    class="col-sm-12 margin-top-5"
                                    style="padding-left: 10px">
                                    <div class="checkbox">
                                        <label> <h:selectBooleanCheckbox
                                                style="margin-top: 2px;"
                                                id="chkhttpclosestep"
                                                value="#{ProzessverwaltungForm.mySchritt.httpCloseStep}" /> #{msgs.httpCloseStep}
                                        </label>
                                    </div>
                                    <h:message
                                        for="chkhttpclosestep"
                                        showDetail="true"
                                        styleClass="help-inline font-danger" />
                                    <intranda:formHelp content="#{msgs.helpHttpCloseStep}" />
                                </div>

                                <div
                                    class="col-sm-12 margin-top-5"
                                    style="padding-left: 10px">
                                    <label>#{msgs.httpMethod}</label>
                                    <h:selectOneMenu
                                        id="httpMethod"
                                        forceId="true"
                                        styleClass="form-control"
                                        value="#{ProzessverwaltungForm.mySchritt.httpMethod}">
                                        <f:selectItems value="#{ProzessverwaltungForm.mySchritt.possibleHttpMethods}" />
                                    </h:selectOneMenu>
                                </div>
                                <div
                                    class="col-sm-12 margin-top-5"
                                    style="padding-left: 10px">
                                    <label>#{msgs.httpUrl}</label>
                                    <h:inputText
                                        id="httpUrl"
                                        forceId="true"
                                        styleClass="form-control"
                                        value="#{ProzessverwaltungForm.mySchritt.httpUrl}" />
                                </div>
                                <div
                                    class="col-sm-12 margin-top-5"
                                    style="padding-left: 10px">
                                    <label>#{msgs.httpBody}</label>
                                    <div class="checkbox">
                                        <label> <h:selectBooleanCheckbox
                                                style="margin-top: 2px;"
                                                id="chkhttpescapejson"
                                                value="#{ProzessverwaltungForm.mySchritt.httpEscapeBodyJson}" /> #{msgs.httpEscapeBodyJson}
                                        </label>
                                    </div>
                                    <h:inputTextarea
                                        styleClass="form-control"
                                        value="#{ProzessverwaltungForm.mySchritt.httpJsonBody}"
                                        onkeyup="checkJSON(event)"></h:inputTextarea>
                                    <h:outputText
                                        id="jsonError"
                                        style="display:none"
                                        styleClass="help-inline font-danger"
                                        value="#{msgs.stepInvalidJsonError}" />
                                </div>
                            </ui:fragment>
                            <x:message
                                for="chkautomatisch"
                                style="color: red"
                                replaceIdWithLabel="true" />
                        </div>
                    </h:panelGroup>

                    <intranda:formInputDropDown
                        id="status"
                        label="#{msgs.status}"
                        field="#{ProzessverwaltungForm.mySchritt.bearbeitungsstatusAsString}"
                        help="#{msgs.helpProcessStepStatus}"
                        name="statusname"
                        selectItems="#{HelperForm.stepStatusList}"
                        required="true" />

                    <intranda:formInputCheckBox
                        id="batchStep"
                        label="#{msgs.batchStep}"
                        field="#{ProzessverwaltungForm.mySchritt.batchStep}"
                        help="#{msgs.helpProcessStepBatch}"
                        name="batch" />

                    <intranda:formInputDropDownWithEmptyValue
                        id="stepPlugin"
                        label="#{msgs.stepPlugin}"
                        field="#{ProzessverwaltungForm.mySchritt.stepPlugin}"
                        help="#{msgs.helpProcessStepPlugin}"
                        name="stepplugin"
                        selectItems="#{ProzessverwaltungForm.possibleStepPlugins}"
                        required="false" />

                    <intranda:formInputDropDownWithEmptyValue
                        id="validationPlugin"
                        label="#{msgs.validationPlugin}"
                        field="#{ProzessverwaltungForm.mySchritt.validationPlugin}"
                        help="#{msgs.helpProcessValidationPlugin}"
                        name="validationplugin"
                        selectItems="#{ProzessverwaltungForm.possibleValidationPlugins}"
                        required="false" />

                    <intranda:formInputCheckBox
                        id="delay"
                        label="#{msgs.timeDelayPlugin}"
                        field="#{ProzessverwaltungForm.mySchritt.delayStep}"
                        help="#{msgs.helpTimeDelayPlugin}"
                        name="timeDelay" />

                    <intranda:formInputCheckBox
                        id="metadataIndex"
                        label="#{msgs.updateMetadataIndex}"
                        field="#{ProzessverwaltungForm.mySchritt.updateMetadataIndex}"
                        help="#{msgs.helpUpdateMetadataIndex}"
                        name="updateMetadataIndex" />

                    <intranda:formInputCheckBox
                        id="generateDocket"
                        label="#{msgs.process_generateDocket}"
                        field="#{ProzessverwaltungForm.mySchritt.generateDocket}"
                        help="#{msgs.helpPrintDocket}"
                        name="generateDocketname" />

                    <div class="form-actions">

                        <!-- Save -->
                        <button
                            class="btn btn-success pull-right font-size-s margin-bottom-most"
                            jsf:id="absenden"
                            jsf:action="#{ProzessverwaltungForm.SchrittUebernehmen}">
                            <span class="fa fa-save margin-right-5" />
                            <h:outputText value="#{msgs.speichern}" />
                            <x:updateActionListener
                                property="#{ProzessverwaltungForm.modusBearbeiten}"
                                value="" />
                        </button>


                        <!-- Cancel -->
                        <button
                            jsf:id="cancel"
                            class="btn margin-sides-10 font-size-s pull-right"
                            jsf:action="#{NavigationForm.Reload}"
                            jsf:immediate="true">
                            #{msgs.abbrechen}
                            <x:updateActionListener
                                property="#{ProzessverwaltungForm.modusBearbeiten}"
                                value="" />
                        </button>

                        <button
                            jsf:id="delete"
                            jsf:action="#{ProzessverwaltungForm.SchrittLoeschen}"
                            class="btn btn-danger font-size-s"
                            onclick="if (!confirm('#{msgs.sollDieserEintragWirklichGeloeschtWerden}')) return false"
                            jsf:rendered="#{ProzessverwaltungForm.mySchritt.id != null}">
                            <span class="fa fa-trash-o margin-right-5" />
                            <h:outputText value="#{msgs.loeschen}" />
                        </button>

                    </div>
                </div>
            </div>
        </h:panelGroup>

        <!-- // Box für die Bearbeitung der Details -->

        <script type="text/javascript">
									if (window.attachEvent) {
										window.attachEvent('onload',
												function(){txtAutomatischAnzeigen(); initThumbCodeMirror(); showThumbsSettings();});
									} else {
										if (window.onload) {
											var curronload = window.onload;
											var newonload = function() {
												curronload();
												txtAutomatischAnzeigen();
												initThumbCodeMirror();
												showThumbsSettings();
											};
											window.onload = newonload;
										} else {
											window.onload = function() {
												txtAutomatischAnzeigen();
												initThumbCodeMirror();
												showThumbsSettings();
											}
										}
									}

									function checkJSON(e) {
										var errMsg = document
												.querySelector("#myform\\:jsonError");
										if (document
												.querySelector("#myform\\:chkhttpescapejson").checked) {
											var valid = true;
											var val = e.target.value;
											try {
												JSON.parse(val);
											} catch (error) {
												valid = false;
											}
											if (!valid) {
												errMsg.style.display = "block";
											} else {
												errMsg.style.display = "none";
											}
										} else {
											errMsg.style.display = "none";
										}
									}

									// Funktion, die Änderungen prüft
									function chkManuellAutomatischSetzen(
											element) {
										//alert(element.id);
										if (element.id != "chkmanuell1")
											document
													.getElementById("chkmanuell1").checked = false;
										if (element.id != "chkmanuell2")
											document
													.getElementById("chkmanuell2").checked = false;
										if (element.id != "chkmanuell3")
											document
													.getElementById("chkmanuell3").checked = false;
										if (element.id != "chkmanuell4")
											document
													.getElementById("chkmanuell4").checked = false;
										//  		if (element.id != "chkautomatisch") document.getElementById("chkautomatisch").checked=false;
										txtAutomatischAnzeigen();
										//element.checked=true;
									}

									function txtAutomatischAnzeigen() {
										var myelement = document
												.getElementById("chkautomatisch");
										if (myelement != null) {
											if (document
													.getElementById("chkautomatisch").checked) {
												document
														.getElementById("scripttable").style.display = "inline";
											} else {
												document
														.getElementById("scripttable").style.display = "none";
											}
										}
										var checkAuto = document
												.querySelector('#automatic');
										if (checkAuto != null) {
											if (checkAuto.checked) {
												$('#messageQueueDropDown')
														.show();
											} else {
												$('#messageQueueDropDown')
														.hide();
											}
										}
									}

									function showThumbsSettings(){
										var element = document.getElementById("autoThumbnail");
										if(element != null){
											if(element.checked){
												document.getElementById("thumbsSettings").style.display="block";
											}else{
												document.getElementById("thumbsSettings").style.display="none";
											}
										}
									}

									var yamlCodeMirror;

									function initThumbCodeMirror(){
										var yamlTextArea = document.getElementById("myform:ThumbSettings")
										if(yamlTextArea) {
											yamlCodeMirror = CodeMirror.fromTextArea(yamlTextArea, {
					    						lineNumbers: true,
					    						mode: 'yaml'
					    					});
											yamlCodeMirror.on('change', editor => {
					    						document.getElementById("myform:ThumbSettings").innerHTML = editor.getValue();
					    				    });
					                	}
									}
								</script>
    </composite:implementation>

</ui:composition>
