<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:of="http://omnifaces.org/functions" xmlns:c="http://java.sun.com/jsp/jstl/core" template="/uii/template/template.html" xmlns:x="http://myfaces.apache.org/tomahawk" xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites" xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

    <ui:param name="myPageTitle" value="#{ProzessverwaltungForm.modusAnzeige=='aktuell'?msgs.aktuelleProzesse:msgs.prozessvorlagen}" />

    <ui:define name="title">
        <h:outputText value="#{myPageTitle}" />
    </ui:define>

    <ui:define name="breadcrumb">
        <intranda:breadcrumb id="id2" label="#{DashboardForm.plugin==null?msgs.startseite:msgs.dashboard}" action="index" navId="a0" />
        <intranda:breadcrumb id="processAll" label="#{myPageTitle}" action="process_all" noSeparator="#{true}" />
    </ui:define>

    <ui:define name="info">
    </ui:define>

    <ui:define name="content">

		<c:if test="#{LoginForm.hasRole('Workflow_Processes') or LoginForm.hasRole('Workflow_ProcessTemplates')}">
								
        <div class="row">
            <div class="col-sm-12">
                <div class="box box-color box-bordered">
                    <div class="box-title">
                        <h3>
                            <i class="fa fa-tasks"></i>
                            <h:outputText value="#{myPageTitle}" />
                        </h3>
                    </div>
                    <div class="box-content nopadding">
                        <div class="dataTables_wrapper">
                            <h:form id="searchform">
                                <div class="dataTables_length" style="margin-bottom: 10px;">
                                    <h:outputText value="#{msgs.treffer}: #{ProzessverwaltungForm.paginator.totalResults}" />
                                </div>

                                <x:aliasBeansScope>
                                    <x:aliasBean alias="#{Form}" value="#{ProzessverwaltungForm}" />
                                    <x:aliasBean alias="#{label}" value="#{msgs.filterProcesses}" />
                                    <f:subview id="sub1">
                                        <ui:include src="includes/task/list_searchAndSave.xhtml" />
                                    </f:subview>
                                </x:aliasBeansScope>

                                <ui:include src="includes/process/list_filterAndDisplay.xhtml" />
                            </h:form>
                            <h:form id="myform">
                                <x:dataTable id="processTable" rowIndexVar="count" styleClass="table table-hover table-nomargin dataTable table-bordered responsive" var="item" value="#{ProzessverwaltungForm.paginator.list}">

                                    <!-- +++++++++++++++++  SelectionBoxes ++++++++++++++++++++++++ -->
                                    <x:column rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['selectionBoxes']}">
                                        <f:facet name="header">
                                            <x:div>
                                                <!-- Header -->
                                                <h:outputText value="#{msgs.auswahl2}" />

                                                <h:commandLink action="#{ProzessverwaltungForm.SelectionAll}" id="selectall" title="#{msgs.alleAuswaehlen}">
                                                    <i class="fa fa-check-square-o font-black margin-left-5" />
                                                </h:commandLink>
                                                <h:commandLink action="#{ProzessverwaltungForm.SelectionNone}" id="selectnone" title="#{msgs.auswahlEntfernen}">
                                                    <i class="fa fa-square-o font-black margin-left-5" />
                                                </h:commandLink>
                                            </x:div>
                                        </f:facet>
                                        <h:commandLink>
                                            <i class="font-black #{item.selected?'fa fa-check-square-o':'fa fa-square-o'}" />
                                            <f:setPropertyActionListener target="#{item.selected}" value="#{item.selected?false:true}" />
                                            <f:ajax render=":myform" />
                                        </h:commandLink>
                                    </x:column>

                                    <!-- +++++++++++++++++  ProzessID ++++++++++++++++++++++++ -->
                                    <x:column rendered="#{ProzessverwaltungForm.anzeigeAnpassen['processId']}" headerstyleClass="#{ProzessverwaltungForm.sortierung=='idDesc'?'sorting_desc':ProzessverwaltungForm.sortierung=='idAsc'?'sorting_asc':'sorting'}">
                                        <f:facet name="header">
                                            <h:commandLink styleClass="font-black-block" action="#{ProzessverwaltungForm.FilterAlleStart}">
                                                <h:outputText value="#{msgs.id}" />
                                                <f:setPropertyActionListener target="#{ProzessverwaltungForm.sortierung}" value="#{ProzessverwaltungForm.sortierung=='idAsc'?'idDesc':'idAsc'}" />
                                                <f:ajax render=":myform" />
                                            </h:commandLink>
                                        </f:facet>
                                        <h:outputText value="#{item.id}" />
                                    </x:column>

                                    <!-- +++++++++++++++++  BatchID ++++++++++++++++++++++++ -->
                                    <x:column rendered="#{ProzessverwaltungForm.anzeigeAnpassen['batchId']}" headerstyleClass="#{ProzessverwaltungForm.sortierung=='batchDesc'?'sorting_desc':ProzessverwaltungForm.sortierung=='batchAsc'?'sorting_asc':'sorting'}">
                                        <f:facet name="header">
                                            <h:commandLink styleClass="font-black-block" action="#{ProzessverwaltungForm.FilterAlleStart}">
                                                <h:outputText value="#{msgs.batch}" />
                                                <f:setPropertyActionListener target="#{ProzessverwaltungForm.sortierung}" value="#{ProzessverwaltungForm.sortierung=='batchAsc'?'batchDesc':'batchAsc'}" />
                                                <f:ajax render=":myform" />
                                            </h:commandLink>
                                        </f:facet>
                                        <h:outputText value="#{item.batchID}" rendered="#{item.batchID != null}" />
                                    </x:column>

                                    <!-- +++++++++++++++++  alle Schritte auflisten ++++++++++++++++++++++++ -->
                                    <x:column rendered="true" id="ajaxcolumn" styleClass="tableColumnMaxWidthLong" headerstyleClass="#{ProzessverwaltungForm.sortierung=='titelDesc'?'sorting_desc':ProzessverwaltungForm.sortierung=='titelAsc'?'sorting_asc':'sorting'}">
                                        <f:facet name="header">
                                            <h:commandLink styleClass="font-black-block" action="#{ProzessverwaltungForm.FilterAlleStart}">
                                                <h:outputText value="#{msgs.prozessTitel}" />
                                                <f:setPropertyActionListener target="#{ProzessverwaltungForm.sortierung}" value="#{ProzessverwaltungForm.sortierung=='titelAsc'?'titelDesc':'titelAsc'}" />
                                                <f:ajax render=":myform" />
                                            </h:commandLink>
                                        </f:facet>

                                        <ui:include src="includes/ajaxPlusMinusButton.xhtml" />

                                        <h:panelGroup rendered="#{item.panelAusgeklappt}">
                                            <div class="box box-small box-color box-bordered">
                                                <div class="box-title">
                                                    <h3>
                                                        <i class="fa fa-list"></i>
                                                        #{msgs.details}
                                                    </h3>
                                                </div>
                                                <div class="box-content nopadding">

                                                    <x:dataTable styleClass="table table-hover table-bordered" id="prozessdetails" var="step" value="#{item.schritteList}">

                                                        <h:column>
                                                            <f:facet name="header">
                                                                <h:outputText value="#{msgs.nr}" />
                                                            </f:facet>
                                                            <h:outputText value="#{step.reihenfolge}" />
                                                        </h:column>

                                                        <h:column>
                                                            <f:facet name="header">
                                                                <h:outputText value="#{msgs.titel}" />
                                                            </f:facet>
                                                            <h:outputText value="#{step.titelLokalisiert}" />
                                                        </h:column>

                                                        <h:column>
                                                            <f:facet name="header">
                                                                <h:outputText value="#{msgs.status}" />
                                                            </f:facet>

                                                            <ul class="colors small13">
                                                                <h:panelGroup rendered="#{step.bearbeitungsstatusEnum == 'LOCKED'}">
                                                                    <li class="statusSmall  #{step.bearbeitungsstatusEnum.color}" title="#{msgs.statusGesperrt}" rel="tooltip" />
                                                                </h:panelGroup>
                                                                <h:panelGroup rendered="#{step.bearbeitungsstatusEnum == 'OPEN'}">
                                                                    <li class="statusSmall  #{step.bearbeitungsstatusEnum.color}" title="#{msgs.statusOffen}" rel="tooltip" />
                                                                </h:panelGroup>

                                                                <h:panelGroup rendered="#{step.bearbeitungsstatusEnum == 'DONE' and HelperForm.anonymized}">
                                                                   <li class="statusSmall #{step.bearbeitungsstatusEnum.color}" rel="tooltip" title="#{step.bearbeitungsstatusEnum.title} #{step.editTypeEnum.title}" />
                                                                </h:panelGroup>
                                                                <h:panelGroup rendered="#{step.bearbeitungsstatusEnum == 'INWORK' and HelperForm.anonymized}">
                                                                    <li class="statusSmall  #{step.bearbeitungsstatusEnum.color}" rel="tooltip" title="#{step.bearbeitungsstatusEnum.title}: #{step.editTypeEnum.title}" />
                                                                </h:panelGroup>

                                                                <h:panelGroup rendered="#{step.bearbeitungsstatusEnum == 'DONE' and !HelperForm.anonymized}">
                                                                    <li class="statusSmall  #{step.bearbeitungsstatusEnum.color}" rel="tooltip" title="#{step.bearbeitungsstatusEnum.title}: #{step.bearbeitungsbenutzer!=null and step.bearbeitungsbenutzer.id!=0?step.bearbeitungsbenutzer.nachVorname:''} (#{step.bearbeitungszeitpunkt !=null?step.bearbeitungszeitpunktAsFormattedString:''})  - #{step.editTypeEnum.title}" />
                                                                </h:panelGroup>
                                                                <h:panelGroup rendered="#{step.bearbeitungsstatusEnum == 'INWORK' and !HelperForm.anonymized}">
                                                                    <li class="statusSmall  #{step.bearbeitungsstatusEnum.color}" rel="tooltip" title="#{step.bearbeitungsstatusEnum.title}: #{step.bearbeitungsbenutzer!=null and step.bearbeitungsbenutzer.id!=0?step.bearbeitungsbenutzer.nachVorname:''} (#{step.bearbeitungszeitpunkt !=null?step.bearbeitungszeitpunktAsFormattedString:''})  - #{step.editTypeEnum.title}" />
                                                                </h:panelGroup>
                                                                <h:panelGroup rendered="#{step.bearbeitungsstatusEnum == 'ERROR' and !HelperForm.anonymized}">
                                                                    <li class="statusSmall  #{step.bearbeitungsstatusEnum.color}" rel="tooltip" title="#{step.bearbeitungsstatusEnum.title}: #{step.bearbeitungsbenutzer!=null and step.bearbeitungsbenutzer.id!=0?step.bearbeitungsbenutzer.nachVorname:''} (#{step.bearbeitungszeitpunkt !=null?step.bearbeitungszeitpunktAsFormattedString:''})  - #{step.editTypeEnum.title}" />
                                                                </h:panelGroup>
                                                                <h:panelGroup rendered="#{step.bearbeitungsstatusEnum == 'ERROR' and HelperForm.anonymized}">
                                                                    <li class="statusSmall  #{step.bearbeitungsstatusEnum.color}" rel="tooltip" title="#{step.bearbeitungsstatusEnum.title}: #{step.editTypeEnum.title}" />
                                                                </h:panelGroup>

                                                                <h:panelGroup rendered="#{step.bearbeitungsstatusEnum == 'DEACTIVATED'}">
                                                                    <li class="statusSmall  #{step.bearbeitungsstatusEnum.color}" title="#{step.bearbeitungsstatusEnum.title}" rel="tooltip" />
                                                                </h:panelGroup>                                                                
                                                            </ul>

                                                        </h:column>

                                                    </x:dataTable>

                                                </div>
                                            </div>

                                        </h:panelGroup>
                                    </x:column>


                                    <!-- +++++++++++++++++  Vorgangsdatum ++++++++++++++++++++++++ -->
                                    <x:column rendered="#{ProzessverwaltungForm.anzeigeAnpassen['processDate']}" headerstyleClass="#{ProzessverwaltungForm.sortierung=='vorgangsdatumDesc'?'sorting_desc':ProzessverwaltungForm.sortierung=='vorgangsdatumAsc'?'sorting_asc':'sorting'}">
                                        <f:facet name="header">
                                            <h:commandLink styleClass="font-black-block" action="#{ProzessverwaltungForm.FilterAlleStart}">
                                                <h:outputText value="#{msgs.vorgangsdatum}" />
                                                <f:setPropertyActionListener target="#{ProzessverwaltungForm.sortierung}" value="#{ProzessverwaltungForm.sortierung=='vorgangsdatumAsc'?'vorgangsdatumDesc':'vorgangsdatumAsc'}" />
                                                <f:ajax render=":myform" />
                                            </h:commandLink>
                                        </f:facet>

                                        <h:outputText value="#{item.erstellungsdatum}" />
                                    </x:column>

                                    <!-- +++++++++++++++++  Status ++++++++++++++++++++++++ -->
                                    <x:column styleClass="tableColumnMaxWidthMid" headerstyleClass="#{ProzessverwaltungForm.sortierung=='fortschrittDesc'?'sorting_desc':ProzessverwaltungForm.sortierung=='fortschrittAsc'?'sorting_asc':'sorting'}">
                                        <f:facet name="header">
                                            <h:commandLink styleClass="font-black-block" action="#{ProzessverwaltungForm.FilterAlleStart}">
                                                <h:outputText value="#{msgs.status}" />
                                                <f:setPropertyActionListener target="#{ProzessverwaltungForm.sortierung}" value="#{ProzessverwaltungForm.sortierung=='fortschrittAsc'?'fortschrittDesc':'fortschrittAsc'}" />
                                                <f:ajax render=":myform" />
                                            </h:commandLink>
                                        </f:facet>

                                        <div class="progress margin-bottom-no" title="#{msgs.status}">
											<div title="#{msgs.statusAbgeschlossen}" data-toggle="tooltip" class="progress-bar progress-bar-success" style="width: #{item.fortschritt3}%;"/>
											<div title="#{msgs.statusOffen}" data-toggle="tooltip" class="progress-bar progress-bar-warning" style="width: #{item.fortschritt2}%;"/>
											<div title="#{msgs.statusGesperrt}" data-toggle="tooltip" class="progress-bar progress-bar-danger" style="width: #{item.fortschritt1}%;"/>
                                        </div>

                                    </x:column>


                                    <x:column styleClass="tableColumnMaxWidthMid" headerstyleClass="#{ProzessverwaltungForm.sortierung=='projektDesc'?'sorting_desc':ProzessverwaltungForm.sortierung=='projektAsc'?'sorting_asc':'sorting'}">
                                        <f:facet name="header">
                                            <!-- Header -->
                                            <h:commandLink styleClass="font-black-block" action="#{ProzessverwaltungForm.FilterAlleStart}" title="#{msgs.projekt}">
                                                <h:outputText value="#{msgs.projekt}" />
                                                <f:setPropertyActionListener target="#{ProzessverwaltungForm.sortierung}" value="#{ProzessverwaltungForm.sortierung=='projektAsc'?'projektDesc':'projektAsc'}" />
                                                <f:ajax render=":myform" />
                                            </h:commandLink>
                                        </f:facet>
                                        <h:outputText value="#{item.projekt.titel}" />
                                    </x:column>


                                    <x:column rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['lockings']}">
                                        <f:facet name="header">
                                            <x:div>
                                                <!-- Header -->
                                                <h:outputText value="#{msgs.sperrungen}" />

                                            </x:div>
                                        </f:facet>
                                        <h:outputText value="#{item.benutzerGesperrt.nachVorname}" rendered="#{item.benutzerGesperrt != null}" />
                                    </x:column>



                                    <!-- +++++++++++++++++  Swapped out ++++++++++++++++++++++++ -->
                                    <x:column rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.anzeigeAnpassen['swappedOut']}">
                                        <f:facet name="header">
                                            <x:div>
                                                <!-- Header -->
                                                <h:outputText value="#{msgs.ausgelagert}" />
                                            </x:div>
                                        </f:facet>
                                        <i class="fa #{item.swappedOutGui?'fa-check-square-o':'fa-square-o'}" />
                                    </x:column>

                                    <x:column style="width:180px;">
                                        <f:facet name="header">
                                            <h:outputText value="#{msgs.auswahl}" />
                                        </f:facet>

	                                        <h:commandLink action="#{ProzessverwaltungForm.editProcess}" rel="tooltip" id="edit"
	                                        rendered="#{LoginForm.hasRole('Workflow_General_Details')}" title="#{msgs.prozessBearbeiten}">
                                            <i class="btn fa fa-pencil" />
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <x:updateActionListener property="#{ProzessverwaltungForm.myProzess}" value="#{item}" />
                                            <x:updateActionListener property="#{ProzessverwaltungForm.modusBearbeiten}" value="" />
                                        </h:commandLink>

                                        <!-- Bearbeiten-Schaltknopf: Vorlagen -->
                                        <h:commandLink action="#{ProzessverwaltungForm.editProcess}" rel="tooltip" rendered="#{(LoginForm.maximaleBerechtigung == 1 or LoginForm.maximaleBerechtigung == 2) and (ProzessverwaltungForm.modusAnzeige=='vorlagen')}" title="#{msgs.prozessBearbeiten}">
                                            <i class="btn fa fa-pencil" />
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <x:updateActionListener property="#{ProzessverwaltungForm.myProzess}" value="#{item}" />
                                            <x:updateActionListener property="#{ProzessverwaltungForm.modusBearbeiten}" value="" />
                                        </h:commandLink>
                                        
                                        <!-- Duplicate process template -->
	                                        <h:commandLink action="#{ProzessverwaltungForm.cloneProcess}" rel="tooltip" rendered="#{LoginForm.hasRole('Workflow_ProcessTemplates_Clone') and (ProzessverwaltungForm.modusAnzeige=='vorlagen')}" title="#{msgs.duplicateWorkflow}"
                                        	onclick="if (!confirm('#{msgs.wirklichAusfuehren}')) return false">
                                            <i class="btn fa fa-clipboard" />
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <x:updateActionListener property="#{ProzessverwaltungForm.myProzess}" value="#{item}" />
                                        </h:commandLink>
                                        
	                                        <!-- Metadaten-Schaltknopf - Read only -->
	                                        <h:commandLink action="#{Metadaten.XMLlesen}" id="action14" title="#{msgs.metadatenBearbeiten}" rel="tooltip" rendered="#{(!LoginForm.hasRole('Task_Mets_Pagination') and !LoginForm.hasRole('Task_Mets_Structure') and !LoginForm.hasRole('Task_Mets_Metadata') and !LoginForm.hasRole('Task_Mets_Files')) and item.benutzerGesperrt == null and ProzessverwaltungForm.modusAnzeige!='vorlagen'}">
                                            <i class="btn fa fa-book" />
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <f:param name="nurLesen" value="true" />
                                            <f:param name="ProzesseID" value="#{item.id}" />
                                            <f:param name="BenutzerID" value="#{LoginForm.myBenutzer.id}" />
                                            <f:param name="zurueck" value="process_all" />
                                        </h:commandLink>

	                                        <!-- Metadaten-Schaltknopf - Allow writing -->
	                                        <h:commandLink action="#{Metadaten.XMLlesen}" id="action15" title="#{msgs.metadatenBearbeiten}" rel="tooltip" rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and (LoginForm.hasRole('Task_Mets_Pagination') or LoginForm.hasRole('Task_Mets_Structure') or LoginForm.hasRole('Task_Mets_Metadata') or LoginForm.hasRole('Task_Mets_Files')) and !item.temporaryMetadataFiles}">
                                            <i class="btn fa fa-book " />
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <f:param name="ProzesseID" value="#{item.id}" />
                                            <f:param name="BenutzerID" value="#{LoginForm.myBenutzer.id}" />
                                            <f:param name="zurueck" value="process_all" />
	                                            <c:if test="#{LoginForm.hasRole('Task_Mets_Files')}">
	                                            	<f:setPropertyActionListener value="File" target="#{Metadaten.modusAnsicht}" />
	                                            </c:if>
	                                            <c:if test="#{LoginForm.hasRole('Task_Mets_Metadata')}">
	                                            	<f:setPropertyActionListener value="Metadaten" target="#{Metadaten.modusAnsicht}" />
	                                            </c:if>
	                                            <c:if test="#{LoginForm.hasRole('Task_Mets_Structure')}">
	                                            	<f:setPropertyActionListener value="Strukturdaten" target="#{Metadaten.modusAnsicht}" />
	                                            </c:if>
	                                            <c:if test="#{LoginForm.hasRole('Task_Mets_Pagination')}">
	                                            	<f:setPropertyActionListener value="Paginierung" target="#{Metadaten.modusAnsicht}" />
	                                            </c:if>
                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc1}" />
                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc2}" />
                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc3}" />
                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc4}" />
                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc5}" />
                                        </h:commandLink>
                                        
                                        <!--  modal rendern  -->
	                                        <h:panelGroup rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and (LoginForm.hasRole('Task_Mets_Pagination') or LoginForm.hasRole('Task_Mets_Structure') or LoginForm.hasRole('Task_Mets_Metadata') or LoginForm.hasRole('Task_Mets_Files')) and item.temporaryMetadataFiles}">
                                            <a class="text_head" title="#{msgs.metadatenBearbeiten}" href="#" data-toggle="modal" data-target="#myModal-#{count}">
                                                <i class="btn fa fa-book " />
                                            </a>
                                        </h:panelGroup>
                                        <div class="modal fade" id="myModal-#{count}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">

                                                        <a href="#" class="btn btn-blue pull-right" title="#{msgs.cancel}" data-dismiss="modal">
                                                            <i class="fa fa-times"></i>
                                                        </a>
                                                        <h4 class="modal-title" id="myModalLabel">
                                                            <h:outputText value="#{msgs.metseditorOpen}" />
                                                        </h4>
                                                    </div>
                                                    <div class="modal-body">
                                                        <h:outputText value="#{msgs.metseditorTemporaryDataExplanation}" />
                                                    </div>
                                                    <div class="modal-footer">

                                                        <h:commandLink action="#{Metadaten.XMLlesen}" id="action15a" title="#{msgs.discard}" rel="tooltip" styleClass="btn btn-lightred pull-left">
                                                            <i class="fa fa-trash-o margin-right-10"></i>
                                                            <h:outputText value="#{msgs.discard}" />
                                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                                            <f:param name="ProzesseID" value="#{item.id}" />
                                                            <f:param name="BenutzerID" value="#{LoginForm.myBenutzer.id}" />
                                                            <f:param name="zurueck" value="process_all" />
                                                            <f:param name="discardChanges" value="true" />
                                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc1}" />
                                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc2}" />
                                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc3}" />
                                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc4}" />
                                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc5}" />
                                                        </h:commandLink>

                                                        <h:commandLink action="#{Metadaten.XMLlesen}" id="action15b" title="#{msgs.overwrite}" rel="tooltip" styleClass="btn btn-green">
                                                            <i class="fa fa-floppy-o margin-right-10"></i>
                                                            <h:outputText value="#{msgs.overwrite}" />
                                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                                            <f:param name="ProzesseID" value="#{item.id}" />
                                                            <f:param name="BenutzerID" value="#{LoginForm.myBenutzer.id}" />
                                                            <f:param name="zurueck" value="process_all" />
                                                            <f:param name="overwriteChanges" value="true" />
                                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc1}" />
                                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc2}" />
                                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc3}" />
                                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc4}" />
                                                            <f:setPropertyActionListener value="#{null}" target="#{NavigationForm.uiStatus.mets_toc5}" />
                                                        </h:commandLink>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>


                                        <!-- DMS-Export-Schaltknopf -->
	                                        <h:commandLink action="#{ProzessverwaltungForm.ExportDMS}" id="action21" title="#{msgs.importDms}" rel="tooltip" styleClass="font-light" rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and LoginForm.hasRole('Workflow_Processes_Allow_Export') and item.displayDMSButton}">
                                            <i class="btn fa fa-globe" />
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <x:updateActionListener property="#{ProzessverwaltungForm.myProzess}" value="#{item}" />
                                        </h:commandLink>

                                        <!-- DMS-Export-Schaltknopf greyed -->
	                                        <h:commandLink action="#{ProzessverwaltungForm.ExportDMS}" disabled="true" title="#{msgs.importDms}" rel="tooltip" rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and LoginForm.hasRole('Workflow_Processes_Allow_Export') and !item.displayDMSButton}">
                                            <i class="btn font-light fa fa-globe" />
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <x:updateActionListener property="#{ProzessverwaltungForm.myProzess}" value="#{item}" />
                                        </h:commandLink>
                                        
                                        <!-- ProzessKopie-Schaltknopf -->
	                                        <h:commandLink action="#{ProzesskopieForm.Prepare}" id="action22" rel="tooltip" title="#{item.containsUnreachableSteps?msgs.prozessvorlageMitUnvollstaendigenSchrittdetails:msgs.eineKopieDieserProzessvorlageAnlegen}" rendered="#{ProzessverwaltungForm.modusAnzeige=='vorlagen' and LoginForm.hasRole('Workflow_ProcessTemplates_Import_Single')}">
                                            <i class="btn fa #{item.containsUnreachableSteps?'fa-file-o btn-danger':'fa-file-o btn-primary'} " />
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <x:updateActionListener property="#{ProzesskopieForm.prozessVorlage}" value="#{item}" />
                                        </h:commandLink>

                                        <!-- MassenImport -->
	                                        <h:commandLink action="#{MassImportForm.Prepare}" id="action222" title="#{msgs.MassenImport}" rel="tooltip" rendered="#{ProzessverwaltungForm.modusAnzeige=='vorlagen' and HelperForm.massImportAllowed and LoginForm.hasRole('Workflow_ProcessTemplates_Import_Multi')}">
                                            <i class="btn fa #{item.containsUnreachableSteps?'fa-files-o btn-danger':'fa-files-o btn-primary'} " />
                                            <f:passThroughAttribute name="data-toggle" value="tooltip" />
                                            <x:updateActionListener property="#{MassImportForm.template}" value="#{item}" />
                                        </h:commandLink>

	                                        <h:panelGroup rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and (LoginForm.hasRole('Workflow_Processes_Allow_Download') or LoginForm.hasRole('Workflow_Processes_Allow_Linking'))}">
                                            <div class="btn-group margin-left-10" title="#{msgs.additionalOptions}" data-toggle="tooltip">

                                                <a class="btn dropdown-toggle fa fa-cog" data-toggle="dropdown">
                                                    <span class="caret"></span>
                                                </a>
                                                <ul class="dropdown-menu pull-right">

	                                                    <h:panelGroup rendered="#{LoginForm.hasRole('Workflow_Processes_Allow_Linking')}">
                                                       <li>
                                                            <!-- Download-Schaltknopf -->
                                                            <h:commandLink action="#{ProzessverwaltungForm.DownloadToHome}" id="action16" title="#{msgs.imHomeVerzeichnisVerlinken}" rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and !item.imageFolderInUse}">
                                                                <i class="fa fa-cloud-download margin-right-10" />
                                                                <h:outputText value="#{msgs.imHomeVerzeichnisVerlinken}" />
                                                                <x:updateActionListener property="#{ProzessverwaltungForm.myProzess}" value="#{item}" />
                                                            </h:commandLink>
                                                        </li>
                                                        <li>
                                                            <!-- Download-Schaltknopf -->
                                                            <h:commandLink action="#{ProzessverwaltungForm.DownloadToHome}" id="action17" title="#{msgs.imHomeVerzeichnisVerlinkenTrotzBearbeitung}" onclick="if (!confirm('#{msgs.warningAdminBeforeLinking}')) return false" rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and item.imageFolderInUse}">
                                                                <i class="fa fa-cloud-download margin-right-10" />
                                                                <h:outputText value="#{msgs.imHomeVerzeichnisVerlinkenTrotzBearbeitung}" />
                                                                <x:updateActionListener property="#{ProzessverwaltungForm.myProzess}" value="#{item}" />
                                                            </h:commandLink>
                                                        </li>
                                                        <li>
                                                            <!-- Upload-Schaltknopf -->
                                                            <h:commandLink action="#{ProzessverwaltungForm.UploadFromHome}" id="action18" title="#{msgs.ausHomeverzeichnisEntfernen}" onclick="if (!confirm('#{msgs.ausHomeverzeichnisEntfernen}')) return false" rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen'}">
                                                                <i class="fa fa-cloud-upload margin-right-10" />
                                                                <h:outputText value="#{msgs.ausHomeverzeichnisEntfernen}" />
                                                                <x:updateActionListener property="#{ProzessverwaltungForm.myProzess}" value="#{item}" />
                                                            </h:commandLink>
                                                        </li>
                                                    </h:panelGroup>

														<h:panelGroup rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and LoginForm.hasRole('Workflow_Processes_Allow_Download')}">
                                                    <li>
                                                        <!-- XML Export-Schaltknopf -->
		                                                        <h:commandLink id="ubid119" action="#{ProzessverwaltungForm.CreateXML}" title="#{msgs.createXML}">
                                                            <i class="fa fa-floppy-o margin-right-10" />
                                                            <h:outputText value="#{msgs.createXML}" />
                                                            <x:updateActionListener property="#{ProzessverwaltungForm.myProzess}" value="#{item}" />
                                                        </h:commandLink>
                                                    </li>
                                                    <li>
                                                        <!-- Docket Export -->
		                                                        <h:commandLink id="ubid1119" action="#{ProzessverwaltungForm.downloadDocket}" title="#{msgs.laufzettelDrucken}">
                                                            <i class="fa fa-print margin-right-10" />
                                                            <h:outputText value="#{msgs.laufzettelDrucken}" />
                                                            <x:updateActionListener property="#{ProzessverwaltungForm.myProzess}" value="#{item}" />
                                                        </h:commandLink>

                                                    </li>
                                                    <li>
                                                        <!-- Mets-Export-Schaltknopf -->
		                                                        <h:commandLink action="#{ProzessverwaltungForm.ExportMets}" id="action19" title="#{msgs.exportMets}" rendered="#{item.displayMETSButton}">
                                                            <i class="fa fa-floppy-o margin-right-10" />
                                                            <h:outputText value="#{msgs.exportMets}" />
                                                            <x:updateActionListener property="#{ProzessverwaltungForm.myProzess}" value="#{item}" />
                                                        </h:commandLink>
                                                    </li>
                                                    <li>
                                                        <!-- PDF-Export-Schaltknopf -->
		                                                        <h:commandLink action="#{ProzessverwaltungForm.ExportPdf}" id="action20" title="#{msgs.exportPdf}" rendered="#{item.displayPDFButton}">
                                                            <i class="fa fa-floppy-o margin-right-10" />
                                                            <h:outputText value="#{msgs.exportPdf}" />
                                                            <x:updateActionListener property="#{ProzessverwaltungForm.myProzess}" value="#{item}" />
                                                        </h:commandLink>
                                                    </li>
														</h:panelGroup>
                                                </ul>
                                            </div>
                                        </h:panelGroup>
                                    </x:column>

                                </x:dataTable>

                                <div class="dataTables_info" style="float: left;">
                                    <!-- Neu-Schaltknopf -->
                                    <!-- 									 <h:commandLink action="#{ProzessverwaltungForm.Neu}" immediate="true" styleClass="btn btn-primary font-size-s" -->
	                                    <!--                                         rendered="#{LoginForm.hasRole('Workflow_General_Details_Edit') and ProzessverwaltungForm.modusAnzeige!='vorlagen'}" -->
                                    <!--                                         id="new1"> -->
                                    <!--                                         <i class="fa fa-plus margin-right-5"></i> -->
                                    <!--                                         <h:outputText value="#{msgs.einenNeuenProzessAnlegen}" /> -->
                                    <!--                                     </h:commandLink> -->
	                                    <h:commandLink action="#{ProzessverwaltungForm.NeuVorlage}" immediate="true" styleClass="btn btn-primary font-size-s" rendered="#{LoginForm.hasRole('Workflow_General_Details_Edit') and ProzessverwaltungForm.modusAnzeige=='vorlagen'}" id="new2">
                                        <i class="fa fa-plus margin-right-5"></i>
                                        <h:outputText value="#{msgs.eineNeueProzessvorlageAnlegen}" />
                                    </h:commandLink>
                                </div>
                                <div class="dataTables_paginate">
                                    <!-- paginator -->
                                    <intranda:tablePaginator paginator="#{ProzessverwaltungForm.paginator}" id="navigator"/>
                                    <!-- /paginator -->
                                </div>
                            </h:form>

                        </div>
                    </div>
                </div>
            </div>
        </div>


        <h:panelGroup rendered="#{ProzessverwaltungForm.modusAnzeige!='vorlagen' and ProzessverwaltungForm.paginator.list.size() gt 0}">
            <ui:include src="includes/process/list_action.xhtml" />
            <ui:include src="includes/process/list_count.xhtml" />
            <ui:include src="includes/process/list_statistics.xhtml" />
        </h:panelGroup>

		</c:if> 

    </ui:define>

    <!--  
	<ui:define name="sidebar">
		<h:form id="sidebarform">

			

		</h:form>
	</ui:define>
-->
</ui:composition>